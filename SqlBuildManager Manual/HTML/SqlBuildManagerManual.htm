<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Lucida Grande";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
h4
	{mso-style-link:"Heading 4 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;
	font-style:italic;}
h5
	{mso-style-link:"Heading 5 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Cambria","serif";
	color:#243F60;
	font-weight:normal;}
h6
	{mso-style-link:"Heading 6 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Cambria","serif";
	color:#243F60;
	font-weight:normal;
	font-style:italic;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:.25in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:115%;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Calibri","sans-serif";
	font-variant:small-caps;
	font-weight:bold;
	text-decoration:underline;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.1in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	font-variant:small-caps;
	font-weight:bold;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	font-variant:small-caps;}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.4in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	color:#17365D;
	letter-spacing:.25pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	color:#17365D;
	letter-spacing:.25pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	color:#17365D;
	letter-spacing:.25pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:15.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	color:#17365D;
	letter-spacing:.25pt;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{mso-style-link:"Subtitle Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;
	letter-spacing:.75pt;
	font-style:italic;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p
	{margin-right:0in;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.MsoSubtleEmphasis
	{color:gray;
	font-style:italic;}
span.MsoIntenseEmphasis
	{color:#4F81BD;
	font-weight:bold;
	font-style:italic;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
p.separator, li.separator, div.separator
	{mso-style-name:separator;
	margin-right:0in;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
span.apple-converted-space
	{mso-style-name:apple-converted-space;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Cambria","serif";
	color:#17365D;
	letter-spacing:.25pt;}
span.SubtitleChar
	{mso-style-name:"Subtitle Char";
	mso-style-link:Subtitle;
	font-family:"Cambria","serif";
	color:#4F81BD;
	letter-spacing:.75pt;
	font-style:italic;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-link:"Heading 4";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;
	font-style:italic;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-link:"Heading 5";
	font-family:"Cambria","serif";
	color:#243F60;}
span.Heading6Char
	{mso-style-name:"Heading 6 Char";
	mso-style-link:"Heading 6";
	font-family:"Cambria","serif";
	color:#243F60;
	font-style:italic;}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>

<div class=WordSection1>

<div style='border:none;border-bottom:solid #4F81BD 1.0pt;padding:0in 0in 4.0pt 0in'>

<p class=MsoTitle align=center style='text-align:center'>Sql Build Manager - User
Manual</p>

</div>

<p class=MsoSubtitle><span class=MsoSubtleEmphasis><span style='font-style:
normal'>Michael McKechney (</span></span><a
href="mailto:michael@sqlbuildmanager.com"><span class=MsoSubtleEmphasis><span
style='font-style:normal;text-decoration:none'>michael@sqlbuildmanager.com</span></span></a><span
class=MsoSubtleEmphasis><span style='font-style:normal'>) <br>
</span></span><a href="http://www.SqlBuildManager.com"><span
class=MsoSubtleEmphasis><span style='font-style:normal;text-decoration:none'>www.SqlBuildManager.com</span></span></a><span
class=MsoSubtleEmphasis><span style='font-style:normal'> <br>
For: Sql Build Manager v8.6.8<br>
</span></span>Copyright ©2004-2011</p>

<p class=MsoSubtitle align=center style='text-align:center'><span
style='font-size:9.0pt;line-height:115%'>Sql Build Manager&nbsp;is an open
source project maintained by&nbsp;</span><a href="http://mckechney.com/"
target=blank><span style='font-size:9.0pt;line-height:115%'>Michael McKechney</span></a><span
style='font-size:9.0pt;line-height:115%'> on </span><a
href="https://sourceforge.net/projects/sqlsync/"><span style='font-size:9.0pt;
line-height:115%'>SourceForge.net</span></a></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoToc1><span
style='font-variant:normal !important;text-transform:uppercase'><a
href="#_Toc273689277">Starting Topics<span style='color:windowtext;display:
none'>. </span><span
style='color:windowtext;display:none'>4</span></a></span></p>

</div>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689278">Getting Started<span style='color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>4</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689279">Connecting to a database<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>4</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689280">Creating your first Sql Build Manager
Project file<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>5</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689281">Adding Scripts to your project<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>5</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689282">Script Configuration: Setting run time
rules<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>8</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689283">Bulk Add<span style='color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>9</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689284">Bulk Add From List<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>10</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689285">Bulk Add From Text File<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>10</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689286">Changing SQL Server Connection<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>11</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689287">Change SQL Server Menu Option<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>11</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689288">Recent Servers list<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>11</span></a></span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoToc1><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689289">Running Your SQL Builds<span
style='color:windowtext;display:none'>. </span><span
style='color:windowtext;display:none'>12</span></a></span></p>

</div>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689290">Run Time Build Settings<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>12</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689291">Executing your build project<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>13</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689292">Executing the full project<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>13</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689293">Executing select scripts<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>15</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689294">Build Log Information<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>16</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689295">Build History<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>16</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689296">Database Logging<span style='color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>17</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689297">Build File SQL Logging<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>17</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689298">Validating a Build Package<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>18</span></a></span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoToc1><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689299">Basic Command Line Execution<span
style='color:windowtext;display:none'>.. </span><span
style='color:windowtext;display:none'>18</span></a></span></p>

</div>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689300">Command Line Arguments<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>18</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689301">Auto-Creation of Command Line Statements<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>19</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689302">Configuring the command statement<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>19</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689303">Generating the Command statement<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>22</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689304">Command Line Execution via UI<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>23</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689305">Command Line Examples<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>23</span></a></span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoToc1><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689306">Targeting Multiple Servers and Databases<span
style='color:windowtext;display:none'>. </span><span
style='color:windowtext;display:none'>25</span></a></span></p>

</div>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689307">Configuring Multiple Database Targets<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>25</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689308">Manual Sequence Assignment<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>25</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689309">Auto sequence like-named databases<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>26</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689310">Create Configuration via a Query<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>27</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689311">Threaded Multi-Server Database Execution<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>28</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689312">Set-up<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>28</span></a></span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoToc1><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689313">Remote Service Execution and Deployment<span
style='color:windowtext;display:none'>. </span><span
style='color:windowtext;display:none'>29</span></a></span></p>

</div>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689314">Overview<span style='color:windowtext;
display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>29</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689315">Section Detail<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>30</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689316">Pre-testing database connectivity<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>35</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689317">Performing a remote execution<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>35</span></a></span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoToc1><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689318">Advanced Command Line Execution<span
style='color:windowtext;display:none'>.. </span><span
style='color:windowtext;display:none'>36</span></a></span></p>

</div>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689319">Execution Flags<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>36</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689320">Logging<span style='color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>38</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689321">Command Line Return Codes<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>39</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689322">Execution Result codes<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>39</span></a></span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoToc1><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689323">Advanced Script Handling<span
style='color:windowtext;display:none'>.. </span><span
style='color:windowtext;display:none'>40</span></a></span></p>

</div>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689324">Utility Scripts<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>40</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689325">Utility Script Example<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>41</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689326">Simple Text Inserts<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>42</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689327">Token Replacements<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>43</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689328">Script Creation<span style='color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>43</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689329">Script Wrappers<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>45</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689330">Script Manipulation and Optimization<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>47</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689331">Script Policy Checking<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>49</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689332">Manual Policy Checking of Build Package<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>49</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689333">Grant Execute Policy<span style='color:
windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>50</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689334">Grant Execute to [public] Policy<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>50</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689335">WITH (NOLOCK) Policy<span style='color:
windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>50</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689336">Re-runable Script Policy<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>51</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689337">Qualified Table Names Policy<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>51</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689338">Comment Header Policy<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>51</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689339">Stored Procedure Parameter Policy<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>51</span></a></span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoToc1><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689340">Direct Database Object Scripting<span
style='color:windowtext;display:none'>.. </span><span
style='color:windowtext;display:none'>52</span></a></span></p>

</div>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689341">Scripting Database Objects<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>52</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689342">Updating Scripted Objects<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>54</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689343">Creating a “Back out Package”<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>55</span></a></span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoToc1><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689344">Reporting and Adhoc Queries<span
style='color:windowtext;display:none'>. </span><span
style='color:windowtext;display:none'>57</span></a></span></p>

</div>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689345">Script Status Reporting<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>57</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689346">Object Comparison Report<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>59</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689347">Running Adhoc Queries against multiple
targets<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>61</span></a></span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoToc1><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689348">Stored Procedure Testing<span
style='color:windowtext;display:none'>.. </span><span
style='color:windowtext;display:none'>62</span></a></span></p>

</div>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689349">Stored Procedure Testing-Setup<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>63</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689350">Stored Procedure Testing - Execution
(Manual and Automated)<span style='color:windowtext;display:none;text-decoration:
none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>67</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689351">Running your stored procedure tests (manual)<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>67</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689352">Interpreting the results<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>67</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689353">Saving the results<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>68</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689354">Automating stored procedure testing<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>69</span></a></span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoToc1><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689355">Additional Program Information<span
style='color:windowtext;display:none'>.. </span><span
style='color:windowtext;display:none'>69</span></a></span></p>

</div>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689356">Associated File Types<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>69</span></a></span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoToc1><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689357">Database Analysis<span style='color:windowtext;
display:none'>. </span><span
style='color:windowtext;display:none'>71</span></a></span></p>

</div>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689358">Server Analysis<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>72</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689359">Individual Database Details<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>72</span></a></span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoToc1><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689360">Data Extraction and Insertion<span
style='color:windowtext;display:none'>.. </span><span
style='color:windowtext;display:none'>73</span></a></span></p>

</div>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689361">Data Extraction<span style='color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>73</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689362">Data Insertion Script Creation<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>74</span></a></span></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoToc1><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689363">Database Object Validation<span
style='color:windowtext;display:none'>.. </span><span
style='color:windowtext;display:none'>75</span></a></span></p>

<p class=MsoToc1><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689364">Rebuilding Previously Committed Build
Packages<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>77</span></a></span></p>

<p class=MsoToc1><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689365">Enterprise / Team Settings<span
style='color:windowtext;display:none'>. </span><span
style='color:windowtext;display:none'>78</span></a></span></p>

</div>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689366">Enterprise/Team Settings Configuration File<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>78</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689367">appSettings Key/Value Pair<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>79</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689368">Script Change Settings<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>79</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689369">Table Change Watch<span style='color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>79</span></a></span></p>

<p class=MsoToc3><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689370">Configuring Table Change Watch<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>80</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689371">Script Policy Settings<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>80</span></a></span></p>

<p class=MsoToc2><span style='font-variant:normal !important;text-transform:
uppercase'><a href="#_Toc273689372">Feature Access Settings<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>81</span></a></span></p>

<p class=MsoNormal><u><span style='font-size:12.0pt;line-height:115%;
text-transform:uppercase'><span style='text-decoration:none'>&nbsp;</span></span></u></p>

<div class=MsoNormal align=center style='text-align:center'><u><span
style='font-size:12.0pt;line-height:115%;text-transform:uppercase'>

<hr size=2 width="100%" align=center>

</span></u></div>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name=Connectingtoadatabase></a><a name="_Toc273689277"></a><a
name="_Getting_Started"></a>Starting Topics</h1>

</div>

<h2><a name="_Toc273689278">Getting Started</a></h2>

<h3><a name="_Toc273689279"><span class=MsoHyperlink><span style='line-height:
115%;color:#4F81BD;text-decoration:none'>Connecting to a database</span></span></a></h3>

<p class=MsoNormal>Sql Build Manager requires a connection to SQL Server to
start. This is because 99% of its functionality needs a live connection to
work. </p>

<p class=MsoListParagraph style='text-indent:-.25in'><span style='color:black'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>To
get started, run the Sql Build Manager.exe to bring up the connection window:</p>

<p class=separator align=center style='margin-top:12.0pt;margin-right:0in;
margin-bottom:12.0pt;margin-left:0in;text-align:center'><span style='font-size:
9.0pt;font-family:"Lucida Grande","serif";color:black'><img width=258
height=316 src="SqlBuildManagerManual_files/image001.jpg"></span></p>

<p style='margin-top:12.0pt;margin-right:0in;margin-bottom:12.0pt;margin-left:
.5in'><span style='font-size:11.0pt;font-family:"Calibri","sans-serif";
color:black'>The SQL Servers dropdown will scan your network for broadcasting
servers. Once it has done this it will populate the list. If you don't want to
wait or know your server name anyway, you can just type it in.<br>
You can also maintain a list of commonly used servers in the registered Servers
list at the bottom. To do this, right-click on the Registered Servers icon and
use the pop-up menu to guide you.</span></p>

<p style='margin-top:12.0pt;margin-right:0in;margin-bottom:12.0pt;margin-left:
.5in;text-indent:-.25in'><span style='font-size:11.0pt;font-family:"Calibri","sans-serif";
color:black'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:11.0pt;font-family:"Calibri","sans-serif";
color:black'>There are 2 authentication options, Windows Authentication or SQL
Server authentication. By default, it will use Windows Authentication. To enter
a SQL Server ID and password, just uncheck the box. Now that you're ready to
connect, click &quot;Connect&quot; (Don't worry, you can<span
class=apple-converted-space>&nbsp;</span></span><a
href="http://sqlsync.googlepages.com/changingsqlserverconnection"><span
style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:#9DB2DF'>change
your SQL Server connection</span></a><span class=apple-converted-space><span
style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:black'>&nbsp;</span></span><span
style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:black'>after
the application is open)</span></p>

<h3><a name=CreatingyourfirstSqlBuildManagerProjectf></a><a name="_Toc273689280"><span
class=MsoHyperlink><span style='line-height:115%;color:#4F81BD;text-decoration:
none'>Creating your first Sql Build Manager Project file</span></span></a></h3>

<p class=MsoNormal>To get started, you'll want to create a project file to
store your scripts and the run configurations. You have two options when
working with Sql Build Manager projects:<br>
<i><u>Sql Build Manager Project File (.sbm)</u></i> – this is a single self
contained file that will hold all of your scripts and script runtime metadata.
The benefits of this type of file is that by having only one file to manage,
you maintenance and sharing of your scripts if simplified. This is especially
recommended if you need to hand off your packages to a separate group for
deployment.</p>

<p class=MsoNormal><u>Sql Build Manager Build Control File (.sbx)</u> – this
file just contains the run time metadata for your scripts. The scripts are kept
“loose” and are saved in the same folder as the .sbx file. This option works
well when you want to track your scripts in source control as the text changes
will be captured (vs. the binary format of the.sbm file). You can convert a
.sbx file into a .sbm file for deployments using the <span style='font-family:
"Cambria","serif"'>Action </span><span style='font-family:Wingdings'>à</span><span
style='font-family:"Cambria","serif"'> Package Scripts into project file (.sbm)
</span>menu option</p>

<p style='margin-top:12.0pt;margin-right:0in;margin-bottom:12.0pt;margin-left:
.5in;text-indent:-.25in'><span style='font-size:11.0pt;font-family:"Calibri","sans-serif";
color:black'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:11.0pt;font-family:"Calibri","sans-serif";
color:black'>Use the<span class=apple-converted-space>&nbsp;</span></span><span
style='font-size:11.0pt;font-family:"Cambria","serif";color:black'>Actions </span><span
style='font-size:11.0pt;font-family:Wingdings;color:black'>à</span><span
style='font-size:11.0pt;font-family:"Cambria","serif";color:black'> Load/New
Project File (*.sbm)</span><span class=apple-converted-space><span
style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:black'>&nbsp;</span></span><span
style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:black'>or the </span><span
style='font-size:11.0pt;font-family:"Cambria","serif";color:black'>Action </span><span
style='font-size:11.0pt;font-family:Wingdings;color:black'>à</span><span
style='font-size:11.0pt;font-family:"Cambria","serif";color:black'> Load New
Directory Based Build Control Files (*.sbx)</span><span style='font-size:11.0pt;
font-family:"Calibri","sans-serif";color:black'> menu option to open the file
dialog. Navigate to the directory you want the file created and name your
project. Just click the &quot;Open&quot; button to create the project shell.</span></p>

<p class=separator align=center style='margin-top:12.0pt;margin-right:0in;
margin-bottom:12.0pt;margin-left:0in;text-align:center'><span style='font-size:
9.0pt;font-family:"Lucida Grande","serif";color:black'><img border=0 width=352
height=123 src="SqlBuildManagerManual_files/image002.png"></span></p>

<p style='margin-top:12.0pt;margin-right:0in;margin-bottom:12.0pt;margin-left:
0in'><span style='font-size:11.0pt;font-family:"Calibri","sans-serif";
color:black'>Now you're ready to start adding scripts to your project file. See
&quot;</span><a href="#_Adding_Scripts_to"><span style='font-size:11.0pt;
font-family:"Calibri","sans-serif";color:#9DB2DF'>Adding Scripts</span></a><span
style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:black'>&quot;</span></p>

<h3><a name=AddingScriptstoyourproject></a><a name="_Adding_Scripts_to"></a><a
name="_Toc273689281"><span class=MsoHyperlink><span style='line-height:115%;
color:#4F81BD;text-decoration:none'>Adding Scripts to your project</span></span></a></h3>

<p class=MsoNormal>There are 2 basic ways to get your scripts into a project:
by<span class=apple-converted-space><span style='color:black'>&nbsp;</span></span><a
href="#_Adding_an_Existing"><span style='color:#9DB2DF'>adding an existing file</span></a><span
class=apple-converted-space><span style='color:black'>&nbsp;</span></span>or<span
class=apple-converted-space><span style='color:black'>&nbsp;</span></span><a
href="#_Adding_an_Existing"><span style='color:#9DB2DF'>adding the script text</span></a>,
but there are several methods to get access to these:</p>

<p class=MsoListParagraph style='text-indent:-.25in'><span
class=apple-converted-space><span style='font-size:13.0pt;line-height:115%;
font-family:Symbol;color:#4F81BD'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span style='color:black'>Right-Click in the Build Scripts
section and select one of the &quot;Add New...&quot; options<span
class=apple-converted-space>&nbsp;</span></span></p>

<p class=MsoNormal align=center style='margin-top:12.0pt;margin-right:0in;
margin-bottom:12.0pt;margin-left:24.0pt;text-align:center;line-height:normal'><span
style='font-size:9.0pt;font-family:"Lucida Grande","serif";color:black'><img
border=0 width=332 height=158 id="Picture 125"
src="SqlBuildManagerManual_files/image003.png"></span></p>

<p class=MsoListParagraph style='margin-top:12.0pt;margin-right:0in;margin-bottom:
12.0pt;margin-left:.5in;text-indent:-.25in;line-height:normal'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>From the Actions menu, select one of the &quot;Add New...&quot;
options</p>

<p class=MsoNormal align=center style='margin-top:12.0pt;margin-right:0in;
margin-bottom:12.0pt;margin-left:24.0pt;text-align:center;line-height:normal'><span
style='font-size:9.0pt;font-family:"Lucida Grande","serif";color:black'><br>
<img border=0 width=275 height=209 id="Picture 128"
src="SqlBuildManagerManual_files/image004.jpg"></span></p>

<p class=MsoListParagraphCxSpFirst style='margin-top:12.0pt;margin-right:0in;
margin-bottom:12.0pt;margin-left:.5in;text-indent:-.25in;line-height:normal'><span
style='font-size:9.0pt;font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Perform a Bulk Add via the &quot;List&quot; main menu option -
see&nbsp;<a href="http://sqlsync.googlepages.com/bulkaddingscripts"><span
style='color:windowtext;text-decoration:none'>Bulk Adding Scripts</span></a>&nbsp;for
details</p>

<p class=MsoListParagraphCxSpMiddle align=center style='margin-top:12.0pt;
margin-right:0in;margin-bottom:12.0pt;margin-left:.5in;text-align:center;
line-height:normal'><span style='font-size:9.0pt;font-family:"Lucida Grande","serif";
color:black'><img border=0 width=291 height=203
src="SqlBuildManagerManual_files/image005.jpg"></span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Drag and drop files from windows explorer onto the Build Scripts
section</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Drag and drop list entries from one Sql Build Manager instance
into the Build Scripts section of another</p>

<p class=MsoNormal>Each of these methods will then prompt you to configure how
you want the script to be run and against what database.</p>

<h4><a name=AddinganExistingFile></a><a name="_Adding_an_Existing"></a>Adding
an Existing File</h4>

<p class=MsoNormal>To add a pre-saved script file, you will select one of the
&quot;Add New File&quot; menu options. This will present a dialog window for
you to select the script to add. By default, it will fiter for .sql files, but
you can filter for any number of types, and of course an &quot;All Files&quot;.
After you make your selection and click &quot;Open&quot; you will need to<span
class=apple-converted-space><span style='font-size:9.0pt;line-height:115%;
font-family:"Lucida Grande","serif";color:black'>&nbsp;</span></span><a
href="http://sqlsync.googlepages.com/scriptconfiguration"><span
style='color:#9DB2DF'>Configure your Script</span></a><span
class=apple-converted-space><span style='font-size:9.0pt;line-height:115%;
font-family:"Lucida Grande","serif";color:black'>&nbsp;</span></span>to
determine how you want it to run.</p>

<p class=separator align=center style='margin-top:12.0pt;margin-right:0in;
margin-bottom:12.0pt;margin-left:0in;text-align:center'><a
href="http://sqlsync.googlepages.com/add_newfile.png/add_newfile-full;init:.png"><span
style='font-size:9.0pt;font-family:"Lucida Grande","serif";color:#9DB2DF;
text-decoration:none'><img border=0 width=420 height=401 id="Picture 118"
src="SqlBuildManagerManual_files/image006.jpg"
alt="Description: http://sqlsync.googlepages.com/add_newfile.png/add_newfile-large.png"></span></a></p>

<h4><a name=AddingScriptText><span class=MsoHyperlink><span style='color:#4F81BD;
text-decoration:none'>Adding Script Text</span></span></a></h4>

<p class=MsoNormal>To add a script that you will type or paste into your
project file, you will select one of the &quot;Add New Sql Script (Text)&quot;
menu options, or use the hot-key &quot;Ctrl-N&quot;. In this form, you will
need to add a script name, the script itself and then <a
href="#_Script_Configuration:_Setting">Configure your Script</a> to determine
how you want it to run.</p>

<p class=separator align=center style='margin-top:12.0pt;margin-right:0in;
margin-bottom:12.0pt;margin-left:0in;text-align:center'><span style='font-size:
9.0pt;font-family:"Lucida Grande","serif";color:#9DB2DF'><img border=0
width=600 height=280 id="Picture 119"
src="SqlBuildManagerManual_files/image007.jpg"
alt="Description: http://sqlsync.googlepages.com/add_newtext.png/add_newtext-custom;size:600,421.png"></span></p>

<p class=separator align=center style='margin-top:12.0pt;margin-right:0in;
margin-bottom:12.0pt;margin-left:0in;text-align:center'><a
name=ScriptConfigurationSettingRunTimeRules><span style='font-size:9.0pt;
font-family:"Lucida Grande","serif";color:black'>&nbsp;</span></a></p>

<h3><a name="_Toc273689282"></a><a name="_Script_Configuration:_Setting"></a>Script
Configuration: Setting run time rules</h3>

<p class=MsoNormal>No matter how you&nbsp;<a
href="http://sqlsync.googlepages.com/addingscripts"><span style='color:blue'>add
a new script</span></a>&nbsp;to your project file, you will need to configure
your run time rules for that script. There are 10 different attributes you can
add to a script that effect it's description and runtime.</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-size:12.0pt;line-height:115%;font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span style='color:#660000'>Script Name</span></b>&nbsp;-
basically, what it will be called! (Only available if you add via the <span
style='font-family:"Cambria","serif"'>New</span> <span style='font-family:"Cambria","serif"'>Sql
Script (Text)</span> option)</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span style='color:#660000'>Target DB</span></b>&nbsp;- what
database this script will be run on when the package is executed</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span style='color:#660000'>Build Sequence</span></b><span
style='color:#660000'>&nbsp;</span>- determines what order, in relation to the
other scripts in the package, this script should be executed.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span style='color:#660000'>Script Timeout</span></b>&nbsp;-
Set the time (in seconds) of how long&nbsp;<i>Sql Build Manager&nbsp;</i>should
allow the script to run before terminating it and considering it failed.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span style='color:#660000'>Tag</span></b><span
style='color:#660000'>&nbsp;</span>- a short descriptive name used to group
scripts (does not affect run order)</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span style='color:#660000'>Description</span></b><span
style='color:#660000'>&nbsp;</span>- an optional long description of what the
script is and what it's for.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span style='color:#660000'>Roll back entire build on failure</span></b>&nbsp;-
A key feature to the tool. This tells the tool to roll back&nbsp;<b>all</b>&nbsp;of
the changes should this one script fail to execute properly.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span style='color:#660000'>Roll back full script file
contents on partial failure</span></b>&nbsp;- should you uncheck the above; you
then have the granular option of how to handle a failure. If this script
contains more than one command, you can tell the tool to roll back all of the
commands or ignore the failure and keep on going.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span style='color:#660000'>Strip Transaction References</span></b>&nbsp;-
many times, scripts generated by other tools will contain transaction commands.
By selecting this, you tell&nbsp;<i>Sql Build Manager&nbsp;</i>to take those
out and be the sole handler of transactions *it is recommended that you leave
this checked for table schema and data update scripts!</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span style='color:#660000'>Allow Multiple Committed Runs on
same server</span></b>&nbsp;- because&nbsp;<i>Sql Build Manager&nbsp;</i>records
a log of committed package runs, it can tell when a script has already been run
on a server. It the script is constructed to allow running again (a Stored
Procedure update script for instance), you can check this option to have it
execute again.</p>

<p class=MsoNormal align=center style='margin-top:.1in;margin-right:0in;
margin-bottom:0in;margin-left:4.8pt;margin-bottom:.0001pt;text-align:center;
line-height:normal'><i>Configuration widow for &quot;Add File&quot; and
&quot;Bulk Add&quot; options</i><br>
<b><span style='font-family:"Trebuchet MS","sans-serif";color:#9DB2DF;
letter-spacing:2.4pt'><img border=0 width=420 height=230
src="SqlBuildManagerManual_files/image008.jpg"
alt="Description: http://sqlsync.googlepages.com/configuration_newfile.png/configuration_newfile-large.png"></span></b></p>

<p class=MsoNormal align=center style='margin-top:.1in;margin-right:0in;
margin-bottom:0in;margin-left:4.8pt;margin-bottom:.0001pt;text-align:center;
line-height:normal'><i>Configuration window for the &quot;New Sql Script
(Text)&quot; option and whenever editing an existing script</i><b><i><span
style='font-family:"Trebuchet MS","sans-serif";color:#1A4292;letter-spacing:
2.4pt'>.</span></i></b><b><span style='font-family:"Trebuchet MS","sans-serif";
color:#1A4292;letter-spacing:2.4pt'><br>
</span></b><b><span style='font-family:"Trebuchet MS","sans-serif";color:#9DB2DF;
letter-spacing:2.4pt'><img border=0 width=600 height=120 id="Picture 6"
src="SqlBuildManagerManual_files/image009.jpg"
alt="Description: http://sqlsync.googlepages.com/configuration_single.png/configuration_single-custom;size:600,179.png"></span></b></p>

<p class=MsoNormal align=center style='text-align:center'>When editing an
existing file, these configuration options are hidden in the new window. To
display them, use the double arrow icon on the right side of the window.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoTocHeading><a name=BulkAddingScripts>Bulk Adding Scripts</a></p>

</div>

<p class=MsoNormal>There are 3 ways to bulk add scripts into your Sql Build
Project file, all accessed via the List menu item:</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=291 height=203 id="Picture 131"
src="SqlBuildManagerManual_files/image010.jpg"></p>

<h3><a name="_Toc273689283"></a><a name=BulkAdd>Bulk Add</a></h3>

<p class=MsoNormal>This menu option opens a standard windows &quot;File
Open&quot; dialog box. From here, you can select multiple script files to add
by holding the &lt;Shift&gt; or &lt;Ctrl&gt; buttons as you click them.
Clicking &quot;OK&quot; will then present you with the&nbsp;<a
href="#_Script_Configuration:_Setting">script configuration</a>&nbsp;screen.</p>

<h3><a name="_Toc273689284"></a><a name=BulkAddFromList>Bulk Add From List</a></h3>

<p class=MsoNormal>This menu option opens a dialog box where you can type or
paste in a list of files (with full paths) that you want to add to the project
file. Simply add them, one per line, and click the &quot;Add Files&quot; button</p>

<p class=MsoNormal align=center style='text-align:center'><a
href="http://sqlsync.googlepages.com/add_bulklist.png/add_bulklist-full;init:.png"><span
style='color:windowtext;text-decoration:none'><img border=0 width=529
height=233 id="Picture 37" src="SqlBuildManagerManual_files/image011.jpg"
alt="Description: http://sqlsync.googlepages.com/add_bulklist.png/add_bulklist-custom;size:600,320.png"></span></a></p>

<p class=MsoNormal>Next, you will see a confirmation screen. This step is added
in case you are trying to add a script that has the same name as a script
already in the project file. If you do, that item will be shaded and with the
radio button options, you can choose to add a new entry or re-use the existing
one (in either case, the script that is already there will be overwritten). You
can also choose to &quot;Cancel&quot;, or uncheck those files if you have added
them in error. If you click &quot;Add Checked Files&quot; you will be presented
with the&nbsp;<a href="#_Script_Configuration:_Setting">script configuration</a>&nbsp;screen</p>

<p class=MsoNormal align=center style='text-align:center'><a
href="http://sqlsync.googlepages.com/add_bulklist_confirm.png/add_bulklist_confirm-full;init:.png"><span
style='color:windowtext;text-decoration:none'><img border=0 width=600
height=205 src="SqlBuildManagerManual_files/image012.jpg"
alt="Description: http://sqlsync.googlepages.com/add_bulklist_confirm.png/add_bulklist_confirm-custom;size:600,249.png"></span></a></p>

<h3><a name="_Toc273689285"></a><a name=BulkAddFromTextFile>Bulk Add From Text
File</a></h3>

<p class=MsoNormal>Very similar to the <span style='font-family:"Cambria","serif"'>Bulk
Add From List</span> option. Instead of typing or pasting in a list of files in
the screen, this option will pull the list from a text file for you. Just
format the file with one file name per line. You will get the same confirmation
screen as above with the same options, and then be presented with the&nbsp;<a
href="#_Script_Configuration:_Setting">script configuration</a>&nbsp;screen</p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc273689286"></a><a name="_Changing_SQL_Server"></a>Changing SQL
Server Connection</h2>

<p class=MsoNormal>When you&nbsp;<a href="#_Getting_Started">started the
application</a>, you needed to connect to an instance of SQL Server. You can
change your active connection after the tool has started as well. There are 2
ways to accomplish this:</p>

<h3><a name="_Toc273689287">Change SQL Server Menu Option</a></h3>

<p class=MsoNormal>The first is from the Action menu 'Change Sql Server
Connection&quot; menu option. This will display the same connection window you
saw when the application started. It will again enumerate the SQL Servers that
are broadcasting on your network, but you can also type in the server name if
you'd prefer or if your server isn't broadcasting or select from you registered
servers list.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><a
href="http://sqlsync.googlepages.com/connection_change.png/connection_change-full;init:.png"><span
style='color:windowtext;text-decoration:none'><img border=0 width=327
height=119 id="Picture 78" src="SqlBuildManagerManual_files/image013.jpg"
alt="Description: http://sqlsync.googlepages.com/connection_change.png/connection_change-full.png"></span></a>         
<img border=0 width=216 height=265
src="SqlBuildManagerManual_files/image014.jpg"></p>

<h3>&nbsp;<a name="_Toc273689288">Recent Servers list</a></h3>

<p class=MsoNormal>Another option is the &quot;quick change&quot; selection in
the &quot;Recent Servers&quot; dropdown. This list is populated with the last
10 servers that you have connected to and by simply changing your current
selection; you will change the target server. In both this case and the Action
menu option, the new server name will display in the header section.</p>

<p class=MsoNormal align=center style='text-align:center'><a
href="http://sqlsync.googlepages.com/connection_recentServers.png/connection_recentServers-full;init:.png"><span
style='color:windowtext;text-decoration:none'><img border=0 width=337
height=136 id="Picture 80" src="SqlBuildManagerManual_files/image015.jpg"
alt="Description: http://sqlsync.googlepages.com/connection_recentServers.png/connection_recentServers-full.png"></span></a></p>

<p class=MsoNormal>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name="_Toc273689289">Running Your SQL Builds</a></h1>

</div>

<h2><a name=RunTimeBuildSettings></a><a name="_Toc273689290"></a><a
name="_Run_Time_Build"></a>Run Time Build Settings</h2>

<p class=MsoNormal>At run time, there are several settings you can use to
change how the build file is executed against the server.</p>

<p class=MsoNormal style='margin-left:.5in'><strong><span style='font-family:
"Calibri","sans-serif"'>Build Type</span></strong><br>
There are essential 3 different ways to run the project against the server:
Trial, Full/Commit and Partial</p>

<p class=MsoNormal style='margin-left:.5in'><strong><span style='font-family:
"Calibri","sans-serif"'>Trial</span></strong><br>
In trial mode, the build project will be executed, but when complete,&nbsp;<i>it
will roll back the entire project</i>. This allows you to test against a server
in advance to make sure that all of your scripts will execute properly. The
settings that will run a trial are:&nbsp;Trial&nbsp;and&nbsp;Trial - Partial.</p>

<p class=MsoNormal style='margin-left:.5in'><strong><span style='font-family:
"Calibri","sans-serif"'>Full/Commit</span></strong><br>
This is the setting to use when you want the package to commit its changes to
the server upon successful completion. (Of course, if any script fails, the
tool will automatically roll back the changes - after all, that is the point of
the tool :-). The settings that will perform the commit are:&nbsp;Development
Integration,&nbsp;Quality Assurance,&nbsp;User
Acceptance,&nbsp;Staging,&nbsp;Production,&nbsp;Partial&nbsp;and&nbsp;Other.
The only difference is actually just the label that gets applied to the log
that you can use as per your processed.</p>

<p class=MsoNormal style='margin-left:.5in'><strong><span style='font-family:
"Calibri","sans-serif"'>Partial</span></strong><br>
This setting, generally the least commonly used, works in conjunction with the
&quot;Partial Run Start Index&quot; text box. This allows you to specify a
starting mid-point,but run index, of the scripts to run. The settings for this
are:&nbsp;Trial - Partial&nbsp;(will roll back upon completion) and Partial&nbsp;(will
commit upon completion)</p>

<p class=MsoNormal style='margin-left:.5in'><strong><span style='font-family:
"Calibri","sans-serif"'>Target Database Override</span></strong><br>
There may be times during your development cycle, where you will want to
temporarily change the target database for a script (for instance if your
development environment has various versions of the database with different
names (AdventureWorks vs AdventureWorks _Copy for instance). This drop down,
when set, will use the override value for the build execution. Whenever the
tool encounters a script that is configured for a default target that has an
override set, it will use the override instead.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=498 height=180 id="Picture 112"
src="SqlBuildManagerManual_files/image016.jpg"></p>

<p class=MsoNormal style='margin-left:.5in'><strong><span style='font-family:
"Calibri","sans-serif"'>Description</span></strong><br>
Before you start a build execution, you will need to enter a description. This
is used as a brief explanation of why you are updating the database and is kept
in the log. Once some text is entered, build link becomes active, as
&quot;Start Build on &quot;(server name&quot;)</p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc273689291">Executing your build project</a></h2>

<p class=MsoNormal>Now that you've&nbsp;<a href="#_Adding_Scripts_to">added your
scripts</a>,&nbsp;<a href="#_Script_Configuration:_Setting">configured them</a>&nbsp;how
do you actually execute your scripts?&nbsp;You're only a few quick steps
away...</p>

<h3><a name="_Toc273689292"></a><a name="Executingthefullproject&lt;/a&gt;">Executing
the full project</a></h3>

<h4><a name="ConfirmingtargetSQLServer&lt;/a&gt;">Confirming target SQL Server</a></h4>

<p class=MsoNormal>Before you kick off your scripts, check to make sure you're
running them where you want. You can verify the server you're currently
connected to via the header section; both next to the Server label as well as
in the Recent Servers dropdown box (this drop down is a quick way to&nbsp;<a
href="#_Changing_SQL_Server">switch your connection</a>&nbsp;to another server)</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=881 height=98 id="Picture 150"
src="SqlBuildManagerManual_files/image017.jpg"></p>

<h4><a name=SetRunParameters>Set Run Parameters</a></h4>

<p class=MsoNormal>Set your run parameters accordingly (see&nbsp;<a
href="#_Run_Time_Build">here&nbsp;</a>for full details), including the build
type, the target database overrides (if applicable) and a build description
(this becomes part of the&nbsp;<a
href="http://sqlsync.googlepages.com/buildloginformation">log</a>). Once these
are set, the disabled &quot;Please Enter a Description&quot; link will change
to &quot;Start Build {Server Name}&quot; and become active. Click this and your
off and running!</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=469 height=193 id="Picture 156"
src="SqlBuildManagerManual_files/image018.jpg"></p>

<h4>Advanced Runtime Settings: Log Target Database and Run Build without a
Transaction</h4>

<p class=MsoNormal>By default the Advanced Runtime Settings section is hidden.
This is because generally, you don’t want o use them. However, if you need to,
they are there. </p>

<p class=MsoNormal><b>Log Target Database:  </b>By default, Sql Build Manager
logs the execution to a SqlBuild_Logging table in the target database. However,
if you need it to log to a different database for some reason, use this drop
down selector to pick that database (note: it needs to on the same server
instance). This does limit the tool’s ability to determine the script’s run status.</p>

<p class=MsoNormal><b>Run Build without a Transaction: </b>One of the key
features of Sql Build Manager is that it runs the build in a single transaction
and if there is any failure all of the scripts are rolled-back, leaving the
database in a pristine state. You can turn off this protection with this
checkbox. User beware however, because now you’re just running scripts
individually and if there is a failure, all scripts that run before it are
still committed.</p>

<h4><a name="Running/Seeingtheprogress">Running / Seeing the progress</a></h4>

<p class=MsoNormal>Once you click the link to start the build, several things
happen:</p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal>The current status in the bottom status panel changes to
     &quot;Proceeding with Build&quot;</li>
 <li class=MsoNormal>The Build Results list is populated as the scripts are
     run, verifying the run order, the target database it was executed against
     and its status.</li>
 <li class=MsoNormal>A &quot;Cancel&quot; button becomes visible. Clicking this
     will, of course, cancel the build execution and roll back any changes made</li>
</ul>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=600 height=274 id="Picture 142"
src="SqlBuildManagerManual_files/image019.jpg"
alt="Description: http://sqlsync.googlepages.com/run_status.png/run_status-custom;size:600,463.png"></p>

<p class=MsoNormal>Once the build completes, either successfully or with an
error, the final status of the build is shown in the status panel. The example
below shows a script failure, which highlights in red and the status as
&quot;Build Failed and Rolled Back&quot;. To determine the failure, or see the
results of any script that ran, you can right-click on that item in the Build
Results list and select &quot;Display Results&quot;. The pop-up window will
display the SQL Server message and any errors.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=600 height=189 id="Picture 143"
src="SqlBuildManagerManual_files/image020.jpg"
alt="Description: http://sqlsync.googlepages.com/run_failure.png/run_failure-custom;size:600,189.png"></p>

<h3><a name="_Toc273689293"></a><a name=Executingselectscripts>Executing select
scripts</a></h3>

<p class=MsoNormal>If you don't want or need to execute the full build project
from start to finish, you don't have to. From the build scripts list, you can
select one or more scripts and Right-Click to display the menu. Two options are
&quot;Try Script against Database (Rollback)&quot; and &quot;Run Script against
Database (Commit)&quot;. These do exactly what you'd expect them to do. Note
that they will use any Override Target setting you may have set in the
&quot;Build Manager&quot; section.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=401 height=296 id="Picture 144"
src="SqlBuildManagerManual_files/image021.jpg"
alt="Description: http://sqlsync.googlepages.com/run_selectScripts.png/run_selectScripts-custom;size:500,296.png"></p>

<p class=MsoNormal>Just like a full build, you will get the status update in
the &quot;Build Results&quot; section and the final status in the status bar.</p>

<h2><a name=DirectDatabaseObjectScripting></a><a name="_Toc273689294"></a><a
name="_Command_Line_Execution"></a>Build Log Information</h2>

<p class=MsoNormal><i>Sql Build Manager&nbsp;</i>keeps both an internal
(resident in the project file) and external (resident in a logging table on the
target database) logs of build runs. Their contents and uses differ significantly.
.</p>

<h3><a name="_Toc273689295"></a><a name=BuildHistory>Build History</a></h3>

<p class=MsoNormal>The internal logging is called &quot;Build History&quot;.
This records the information about a build run:</p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Start and end time</p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Server run against</p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Description entered by the user</p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Build type</p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Final status (committed, rolled back)</p>

<p class=MsoNoSpacing style='margin-left:.5in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>User id of the person that executed the run</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><a
href="http://sqlsync.googlepages.com/history-main.jpg/history-main-full.jpg"
target="_blank"><span style='color:windowtext;text-decoration:none'><img
border=0 width=600 height=157 id="Picture 164"
src="SqlBuildManagerManual_files/image022.jpg"
alt="Description: http://sqlsync.googlepages.com/history-main.jpg/history-main-custom;size:600,214.jpg"></span></a></p>

<p class=MsoNormal>In addition, it captures details about each script that was
run. The three most useful data points collected are:</p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal><i>Results</i>&nbsp;- the text response from SQL Server
     from the execution of the script. This is especially useful when there is
     an error in the script to help you pin-point it. To view the results in a
     bigger window, select the script line and right-click to</li>
 <li class=MsoNormal><i>Success</i>&nbsp;- an indicator as to whether or not
     the script ran successfully</li>
 <li class=MsoNormal><i>File Hash</i>&nbsp;- a SHA1 hash of the script run.
     This can be used to detect file changes.</li>
</ul>

<h4><a name=Savingbuildhistorytoexternalfile.>Saving build history to external
file.</a></h4>

<p class=MsoNormal>If you need to save off the build history for a build or a
series of builds, you can do that too. While you are in the build history
window above, simply select one or more rows and right-click. Then simply
select the menu option &quot;Save <span style='font-family:"Cambria","serif"'>Build
Details for Selected Rows</span>&quot;. You will be presented with a Save File
dialog so you can save off the detail. This detail is saved in an XML format so
you can read it and also easily parse it if you need to.</p>

<p class=MsoNormal><i>Note</i>: unlike the &quot;Archive Build History&quot;
menu option on the main screen's &quot;Logging&quot; menu, this option does not
remove the build history that is stored in the Sql Build Manager project file -
instead it saves off a copy.</p>

<h3><a name="_Toc273689296"></a><a name=DatabaseLogging>Database Logging</a></h3>

<p class=MsoNormal><i>Sql Build Manager&nbsp;</i>logs all committed
transactions to a table in the target database called SqlBuild_Logging. This
allows the application to set the appropriate indicator icon in the script list
and also allows the application to be able to reconstruct a build project file
from database records (via the <span style='font-family:"Cambria","serif"'>Tools
</span><span style='font-family:Wingdings'>à</span><span style='font-family:
"Cambria","serif"'> Rebuild Previously Committed Build File</span> menu
option). This log is much more detailed that the build history and includes:</p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal>Script Name</li>
 <li class=MsoNormal><i>Script ID</i>&nbsp;(unique identifier for the script)</li>
 <li class=MsoNormal><i>Script File Hash</i>&nbsp;- a means to detect changes
     between runs</li>
 <li class=MsoNormal><i>Commit Date</i></li>
 <li class=MsoNormal><i>Script Text</i>&nbsp;- allows for rebuilding of the
     script if needed</li>
 <li class=MsoNormal><i>Plus more...</i></li>
</ul>

<h3><a name="_Toc273689297"></a><a name=BuildFileSQLLogging></a><a
name="_Build_File_SQL"></a>Build File SQL Logging</h3>

<p class=MsoNormal>A final option for logging is the creation of a SQL log - a
file that contains all of the scripts included in a build, in the order that
they were run (including use statements for their target database) as well as
comments noting the source of the script. This log is formatted such that it is
a fully executable SQL script and can be run independently from any SQL query
window.</p>

<p class=MsoNormal>By default, this is turned off, but it can be set via the
&quot;<span style='font-family:"Cambria","serif"'>Action </span><span
style='font-family:Wingdings'>à</span><span style='font-family:"Cambria","serif"'>Setting
</span><span style='font-family:Wingdings'>à</span><span style='font-family:
"Cambria","serif"'> Create SQL log of Build Runs</span>&quot;. These logs can
be retrieved via &quot;<span style='font-family:"Cambria","serif"'>s</span>&quot;
menu.</p>

<p class=MsoNormal><b>Caution!</b>&nbsp;Having this set all the time can cause
your build file to bloat quickly and unfortunately can slow the general
processing of the file. However, it can be useful is used judiciously.</p>

<h2><a name=ValidatingaBuildPackage></a><a name="_Toc273689298">Validating a
Build Package</a></h2>

<p class=MsoNormal>Often, you will need to “turn-over” your build package to
another group for implementation. In doing so, you want to make sure that the
package you turned over doesn’t get changed or mixed up with another one. Since
the SBM file changes after each execution (the history is saved), the file hash
of the SBM file is an unreliable signature. To solve this problem, you can use
a hash calculated off the scripts themselves. You do this by loading up your
build package, then selecting <span style='font-family:"Cambria","serif"'>Tools
</span><span style='font-family:Wingdings'>à</span><span style='font-family:
"Cambria","serif"'> Calculate Script Package Hash Signature </span>menu option.
</p>

<p class=MsoNormal>This will open up the Hash Signature window with the
calculated SHA1 hash of all the script files together. You can use the <span
style='font-family:"Cambria","serif"'>Copy</span> button to grab the hash value
for publishing. The hash value will not change unless there is a change (no
matter how minor) to the scripts.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=197 height=238 src="SqlBuildManagerManual_files/image023.jpg"><span
style='font-family:Wingdings'>à</span> <img border=0 width=248 height=125
src="SqlBuildManagerManual_files/image024.jpg"></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name="_Toc273689299">Basic Command Line Execution</a></h1>

</div>

<h2><a name="CommandLineArguments&lt;br&gt;"></a><a name="_Toc273689300">Command
Line Arguments</a>&nbsp;</h2>

<p class=MsoNormal>Sql Build Manager can be run directly via command line or
through the SqlBuildManager.Console.exe helper application. The advantage of
using the &quot;console&quot; application is that you will be able to record
exit code values as well as stream the standard output and error text into any
automation or scheduling software that you may be using.</p>

<p class=MsoNormal>In either case, the command line arguments are the same:</p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/build=&quot;&lt;.sbm file name&gt;&quot;</span>&nbsp;<br>
     Lets the tool know that you want to run a Sql Build using the specified
     .sbm file. This is not used alone, but in conjunction with a
     &quot;/server&quot; and/or a &quot;/override&quot; argument.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/server=&lt;server name&gt;</span><br>
     Designates the target server to run the .sbm file against. Used in
     conjunction with &quot;/build&quot;</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/override=&quot;&lt;.multiDb file
     name&gt;&quot;</span><br>
     Sets the&nbsp;<a
     href="http://sqlsync.googlepages.com/multi-databaseserverexecutions">pre-configured
     multi database/server configuration</a>&nbsp;to be used along with the
     .sbm file for the build run.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/override=&lt;default
     database&gt;,&lt;Override database&gt;<br>
     </span>Defines a one-time&nbsp;<a href="#_Run_Time_Build">database override</a>&nbsp;setting
     where the override database is used where ever the default database is
     found in the .sbm file configutation. A &quot;/server&quot; and
     &quot;/build&quot; argument set are also needed.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/auto=&quot;&lt;.sqlauto file name&gt;&quot;</span><br>
     Used independently of the above, this is used to script the database(s)
     defined in the Sql Auto-scripting file.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/test=&quot;&lt;.sptest file name&gt;&quot;</span><br>
     Sets the Stored Procedure test configuration to execute. Used in
     conjunction with &quot;/server&quot;, &quot;/database&quot; and
     &quot;/log&quot; arguments.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/database=&lt;database name&gt;</span><br>
     Sets the database to execute a stored procedure test configuration
     against.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/scriptlogfile=&quot;&lt;script log
     file&gt;&quot;</span><br>
     Allows you to set a destination, outside of the Sql Build Project, where
     the&nbsp;<a href="#_Build_File_SQL">SQL script log</a>&nbsp;will be saved.
     This can be useful if you need to store that information in a particular
     location for auditing.</li>
</ul>

<p class=MsoNormal>NOTE: There are special command line arguments specific just
for&nbsp;<a href="#Execution">threaded multi-database execution&nbsp;</a></p>

<h2><a name=AutoCreationofCommandLineStatements></a><a name="_Toc273689301">Auto-Creation
of Command Line Statements</a></h2>

<p class=MsoNormal>To simplify the creation of a command line execution, the
application offers a user interface to create a command-line for you. You can
then either copy this statement to be used later, or use an execute button to
kick it off then and there.</p>

<h3><a name="_Toc273689302">Configuring the command statement</a></h3>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>From
either the <span style='font-family:"Cambria","serif"'>Tools </span><span
style='font-family:Wingdings'>à</span><span style='font-family:"Cambria","serif"'>
Construct Command line string</span> menu item of the main form or the <span
style='font-family:"Cambria","serif"'>Action </span><span style='font-family:
Wingdings'>à</span><span style='font-family:"Cambria","serif"'> Construct
Command line string</span> menu item from <span style='font-family:"Cambria","serif"'>the
Multi Database Run Configuration</span> form you can open the creation window.</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=357 height=227 src="SqlBuildManagerManual_files/image025.jpg"><img
border=0 width=322 height=219 src="SqlBuildManagerManual_files/image026.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
<a name=CommandLineBuilderOptions><span style='font-family:"Cambria","serif"'>Command
Line Builder</span> form </a>will give you options for each setting.</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=603 height=481 id="Picture 23"
src="SqlBuildManagerManual_files/image027.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Run Settings</b> – How do you want the execution to run</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.75in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><i>Run multi-database as threaded</i> – sets whether or not you
want the tool to thread out the execution. This is checked by default since
this is the biggest benefit of running via command line</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.75in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><i>Run as Trial (rollback) mode</i> – sets whether or not you
want database changes to commit when completed. If checked, all scripts will be
rolled back and leave the target database unchanged</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.75in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><i>Run builds without transactions</i> – allows you to run the
scripts without transactional protection. WARNING! Using this setting will mean
that if a script fails, all previous scripts will still be committed and your
databases will be left in an inconsistent state</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.75in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><i>Description </i>– the description of your build. Any comments
you want to add regarding this execution.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.75in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><i>Allowed Timeout Retry Count </i>– Sets how many times the build
can be retried is the SQL Server error message is “Timeout expired”</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Threaded Run Logging </b>– when running in a threaded mode,
how do you want to create the log files</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.75in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><i>Log File Format </i>– HTML or Plain Text. Obvious. The HTML
format allows you to link from the base log files (commits.html or errors.html)
to easily locate the specific database run logs</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.75in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><i>Root Logging Path </i> - the base folder that you want the log
files and sub-directories to be created</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Script Source – </b>where are the scripts that you want to
run? You can only populate one of these options as a time.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.75in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><i>Sql Build Manager Package (.sbm) </i>– command lines can only
be run from .sbm compiled files, vs .sbx files. This will be the location of
the .sbm file you want to use. NOTE: this will be auto-populated with the path
of the .sbm file that is loaded in the main form if applicable.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.75in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><i>Script Source Directory </i>– if you want to run un-configured
scripts that reside in a folder, you can point this to that directory path. By
doing this, you lose the advantages of configuring run-time settings for
scripts.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Override Target Settings</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.75in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><i>Target Override Settings (.multiDb, .multiQbQ or  .cfg) – </i>the
location of the config file that lists the servers/databases that you want the
multi-database run to execute against. </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Database Authentication Settings</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.75in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><i>Use Windows Authentication – </i>when checked, the connection
to the databases will use the windows account being used to run the execution
as the authentication to the databases</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.75in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><i>UserName –</i><b> </b>enabled if Use Windows Authentication is
unchecked. The SQL Server user to use for the connection.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.75in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><i>Password –</i><b> </b>enabled if Use Windows Authentication us
unchecked. The SQL Server user’s password to use for the connection.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Alternate Logging Database </b>- if you select alternate
database logging (generally NOT recommended as it reduces the effectiveness of
the logging) this is the name of that database.</p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.75in'><b>&nbsp;</b></p>

<h3><a name="_Toc273689303">Generating the Command statement</a></h3>

<p class=MsoNormal>Once you have applied all of your settings in the form, you
can click “Construct Command Line”. The form will validate that you have
populated all necessary settings and configured your options properly. It will
not validate that file paths are correct and files exist (this is because you
may want to set up a command line not relative to where you are setting it up).
The generated command line string will be populated into the box below the
button. Also, the “<span style='font-family:"Cambria","serif"'>Execute</span>”
button will become enabled.</p>

<p class=MsoListParagraph align=center style='text-align:center'><img border=0
width=747 height=143 id="Picture 27"
src="SqlBuildManagerManual_files/image028.png"></p>

<h3><a name="_Toc273689304">Command Line Execution via UI</a></h3>

<p class=MsoNormal>After successfully generating a command line string and the
“<span style='font-family:"Cambria","serif"'>Execute</span>” button is enabled,
you can click it! This will create a command window to run the string via an
external process. You may see a blank command window pop open and remain open
until the execution is complete. When that window closes, the execution output
window will display that output of the execution (hopefully a success
message!).  Also, the “<span style='font-family:"Cambria","serif"'>Open Logging
Folder</span>” button will become enabled. This is a courtesy button to open
the logging folder directly from the application should you want to browse the
log files.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=762 height=170 id="Picture 30"
src="SqlBuildManagerManual_files/image029.png"></p>

<h2><a name="Examples&lt;br&gt;"></a><a name="_Toc273689305">Command Line Examples</a>&nbsp;<br>
<br>
</h2>

<p class=MsoNormal><a name=RunstandardunattendedSqlbuild><strong><span
style='font-family:"Calibri","sans-serif"'>Run standard unattended Sql build</span></strong></a><strong><span
style='font-family:"Calibri","sans-serif"'><br>
</span></strong>Runs the specified .sbm build file on the designated server
using the parameters and target databases defined in the project. The command
line execution uses Windows authentication of the executing process to connect
to the server and database(s). As with in interactive execution, the results
are saved in the .sbm file for review.</p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal><span style='font-family:"Courier New"'>SqlBuildManager.Console.exe
     /build=&quot;.sbm file name&quot; /server=myserver&nbsp;</span></li>
</ul>

<p class=MsoNormal>Example:&nbsp;SqlBuildManager.Console.exe
/build=&quot;ProjectUpdate.sbm&quot; /server=ProdServer&nbsp;</p>

<p class=MsoNormal><a name=RunanunattendedSqlbuildwithmanualdatabas><strong><span
style='font-family:"Calibri","sans-serif"'>Run an unattended Sql build with
manual database override settings</span></strong></a><strong><span
style='font-family:"Calibri","sans-serif"'><br>
</span></strong>Runs the specified .sbm build file on the designated server
using the override database settings defined in the command line arguments.
This is the same as using the Target Database Override setting in the UI
(see&nbsp;<a href="http://sqlsync.googlepages.com/buildrunsettings">Build Run
Settings</a>&nbsp;for details). The command line execution uses Windows
authentication of the executing process to connect to the server and
database(s). As with in interactive execution, the results are saved in the
.sbm file for review.</p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal><span style='font-family:"Courier New"'>SqlBuildManager.Console.exe
     /build=&quot;.sbm file name&quot; /server=server
     /override=default,override</span></li>
</ul>

<p class=MsoNormal>Example:&nbsp;SqlBuildManager.Console.exe /build=&quot;ProjectUpdate.sbm&quot;
/server=ProdServer /override=Main,Copy1</p>

<p class=MsoNormal>Note that multiple overrides may be set if the build file
contains more than one default database setting via a semi-colon delimited
list:/override:Main,Copy1;Template,Template2&gt;</p>

<p class=MsoNormal><a name=RunanunattendedSqlbuildwithsavedMultiDbc><strong><span
style='font-family:"Calibri","sans-serif"'>Run an unattended Sql build with
saved Multi Db configuration</span></strong></a><strong><span style='font-family:
"Calibri","sans-serif"'><br>
</span></strong>Runs the specified .sbm build file using a pre-configured
multiple server/database configuration. The command line execution uses Windows
authentication of the executing process to connect to the server and
database(s). As with in interactive execution, the results are saved in the
.sbm file for review.</p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal><span style='font-family:"Courier New"'>SqlBuildManager.Console.exe
     /build &quot;.sbm file name&quot; /override &quot;.multiDb File Name&quot;</span></li>
</ul>

<p class=MsoNormal>Example:&nbsp;<br>
SqlBuildManager.Console.exe /build=&quot;ProjectUpdate.sbm&quot; /override=&quot;prod
release.multiDb&quot;</p>

<p class=MsoNormal><a name=ScriptdatabasesusinganAutoScriptconfigur><strong><span
style='font-family:"Calibri","sans-serif"'>Script databases using an Auto
Script configuration</span></strong></a><strong><span style='font-family:"Calibri","sans-serif"'><br>
</span></strong>Uses Sql Build Manager's database scripting feature to script
the designated server/database objects to a target folder.</p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal><span style='font-family:"Courier New"'>SqlBuildManager.Console.exe
     /auto=&quot;.sqlauto script cfg file&quot;</span></li>
</ul>

<p class=MsoNormal>Example: SqlBuildManager.Console.exe&nbsp;/auto &quot;script
dev databases.sqlauto&quot;</p>

<p class=MsoNormal><a name=RunningaStoredProcedureTestconfiguration><strong><span
style='font-family:"Calibri","sans-serif"'>Running a Stored Procedure Test
configuration set</span></strong></a><strong><span style='font-family:"Calibri","sans-serif"'><br>
</span></strong>Utilizes Sql Build Manager's ability to&nbsp;<a
href="http://sqlsync.googlepages.com/storedproceduretesting">perform unit tests
against stored procedures</a>&nbsp;and saves the results in a parseable XML
data format.</p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal><span style='font-family:"Courier New"'>SqlBuildManager.Console.exe
     /test=&quot;.sptest file&quot; /server=myserver&nbsp;/database=myDb
     /log=logfile.xml</span></li>
</ul>

<p class=MsoNormal>Example:&nbsp;SqlBuildManager.Console.exe /test=&quot;testing.sptest&quot;
/server=Production /database=myDb /log=&quot;C:\logfile.xml&quot;</p>

<p class=MsoNormal><a name=OpeninganinteractiveBuildManagerSession><strong><span
style='font-family:"Calibri","sans-serif"'>Opening an interactive Build Manager
Session</span></strong></a><strong><span style='font-family:"Calibri","sans-serif"'><br>
</span></strong>Opens the selected .sbm build project file in a user window</p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal><span style='font-family:"Courier New"'>&quot; Sql Build
     Manager.exe&quot; &quot;.sbm file name&quot;</span></li>
</ul>

<p class=MsoNormal>See <a href="#AdvancedCommandLineExecution">Advanced Command
Line Execution</a> for return codes.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name=TargetingMultipleServersandDatabases></a><a name="_Toc273689306"></a><a
name="_Toc226946966">Targeting Multiple Servers and Databases</a></h1>

</div>

<p class=MsoNormal><a name="_Configuring_Multiple_Database"></a>NOTE: For more
advanced multiple target database deployment, also see <a
href="#RemoteServicsExecutionandDeployment">Remote Service Execution and
Deployment</a> </p>

<h2><a name="_Toc273689307">Configuring Multiple Database Targets</a></h2>

<p class=MsoNormal>To execute commands across multiple databases at once, you
will need to configure which databases you want to target. There are multiple
ways to configure these targets and the default sequence of execution. For each
however, you open up the “<span style='font-family:"Cambria","serif"'>Multiple
Database Run Configuration</span>” window via the <span style='font-family:
"Cambria","serif"'>Sql Build Manager</span> window, <span style='font-family:
"Cambria","serif"'>Action </span><span style='font-family:Wingdings'>à</span><span
style='font-family:"Cambria","serif"'> Configure Multi Server/Database Run </span>menu
option</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=254 height=314 src="SqlBuildManagerManual_files/image030.jpg"></p>

<p class=MsoNormal>The default window opened when opening the Multiple Database
Run Configuration window will have a single main tab for the server that your
main window is connected to. It will have a sub-tab for each database that you
have configured in the open Sql Build File (.sbm or .sbx) that you have open.</p>

<p class=MsoNormal>Configurations can be saved via the Action<span
style='font-family:Wingdings'>à</span> Save Configuration menu of the Multiple
Database Run Configuration window. These are saved as <span style='font-family:
"Cambria","serif"'>.multiDb</span> files</p>

<p class=MsoNormal>Pre-defined configurations can be loaded from the <span
style='font-family:"Cambria","serif"'>Action </span><span style='font-family:
Wingdings'>à</span><span style='font-family:"Cambria","serif"'> Load
Configuration</span> menu of the <span style='font-family:"Cambria","serif"'>Multiple
Database Run Configuration </span>window or via the<span style='font-family:
"Cambria","serif"'> Recent Files </span>menu if available.</p>

<h3><a name="_Toc273689308">Manual Sequence Assignment</a></h3>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Manual
assignment consists of typing in the sequence of execution for target databases
in the boxes provided. These will be the database names that are used for the
override target of the sub-tab named database if you are configuring a
multi-database build or will define the target databases for a report
generation.</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=370 height=321 src="SqlBuildManagerManual_files/image031.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
you need to add additional server targets, you can use the <span
style='font-family:"Cambria","serif"'>Action </span><span style='font-family:
Wingdings'>à</span><span style='font-family:"Cambria","serif"'> Add Another
Server Configuration</span> menu option and use the connection window to add
that server and its database list to the top level tabs. You would then
configure the target database for this server also by manually typing in the
sequence number.</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=350 height=139 id="Picture 4"
src="SqlBuildManagerManual_files/image032.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>To
remove a server configuration that you don’t need, make sure that its tab is
selected, then click the <span style='font-family:"Cambria","serif"'>Remove</span>
button on that configuration</p>

<p class=MsoListParagraphCxSpLast>&nbsp;</p>

<h3><a name="_Toc273689309">Auto sequence like-named databases</a></h3>

<p class=MsoNormal>To aid in the assignment of database targets, you can auto
fill the sequence textbox for databases that have similar names.</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>In
the server configuration tab, right-click on a database name to display the
context menu and select the <span style='font-family:"Cambria","serif"'>Auto
Sequence Target Databases</span> option</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=438 height=132 src="SqlBuildManagerManual_files/image033.png"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
auto sequence pop-up window will display. In this window, highlight the portion
of the database name that is common to all those that you want to sequence. You
can also set the starting sequence number and the increment for sequencing in
this box. Once you have this configured, click the <span style='font-family:
"Cambria","serif"'>OK</span> button and all of the databases that match the
common pattern in their name will be sequenced accordingly.</p>

<p class=MsoListParagraphCxSpLast align=center style='text-align:center'><img
border=0 width=453 height=150 src="SqlBuildManagerManual_files/image034.jpg"></p>

<h3><a name=CreateConfigurationviaaQuery></a><a name="_Toc273689310"></a><a
name="_Create_Configuration_via"></a>Create Configuration via a Query</h3>

<p class=MsoNormal>If your target database list is available via a SQL query,
you can use that query to generate a multi-database configuration file at run
time.</p>

<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:
"Cambria","serif"'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>From the <span style='font-family:"Cambria","serif"'>Multiple
Database Run Configuration </span>window select the <span style='font-family:
"Cambria","serif"'>Load Configuration via Query.</span></p>

<p class=MsoNormal align=center style='margin-left:.25in;text-align:center'><img
border=0 width=549 height=247 src="SqlBuildManagerManual_files/image035.jpg"></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>In
this window, you can type in the query that you will use to retrieve your
database list. The query must return 3 columns worth of data in order (the
column names are unimportant):<br>
<span style='font-family:"Courier New"'>Server Name</span>: The server that the
target database can be found on. This is needed even if the target database is
on the same server as the default database. <br>
<span style='font-family:"Courier New"'>Default DB Name</span>: the default
database that is configured in the “Database Name” column of the Build Scripts
window. <br>
<span style='font-family:"Courier New"'>Override DB Name</span>: This is the
name of the target database that you actually want to execute against</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If
you want to add additional data from this source that will appear in an <a
href="#RunningAdhocQueriesagainstmultiple">Adhoc query</a>, you can put in
additional columns after the &lt;&lt;override Db Name&gt;&gt; entry and these
values will carry over into the Adhoc query results</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>You
can also load an existing query setting (.multiDbQ file) via the <span
style='font-family:"Cambria","serif"'>Action </span><span style='font-family:
Wingdings'>à</span><span style='font-family:"Cambria","serif"'> Open Saved
Query Configuration</span> or <span style='font-family:"Cambria","serif"'>Recent
Files</span> menu options.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>You
can change the source database (the database this configuration query will be
executed against) via the dropdown list.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>You
can change the source server (the server where the source database resides) via
the <span style='font-family:"Cambria","serif"'>Action </span><span
style='font-family:Wingdings'>à</span><span style='font-family:"Cambria","serif"'>
Change Sql Server Connection </span>menu option.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Click
“Create Configuration” button to generate the configuration file. You will then
be prompted to save the query as a .multiDbQ file (optional). The query window
will close and the newly generated configuration setting will be loaded in the <span
style='font-family:"Cambria","serif"'>Multiple Database Run Configuration</span>
window.</p>

<h2>&nbsp;</h2>

<h2><a name="_Toc273689311">Threaded Multi-Server Database Execution</a></h2>

<p class=MsoNormal>Do you need a fast, multi-threaded execution of your scripts
across a large number of databases? The threaded option is right for you. With
a few command line settings, you can set up your&nbsp;<i>Sql Build Manager</i>&nbsp;project
to get executed across hundreds, even thousands of databases in a parallel
threaded fashion.</p>

<p class=MsoNormal><i>NOTE</i>: While this type of execution still manages
transactions per each SBM file execution, it does not manage all of the
transactions together like when run in a serial mode. If the scripts run on one
database are successful, they will be committed, even though the scripts for
another database may fail and be rolled back.&nbsp;</p>

<h3><a name="_Toc273689312"></a><a name=Set-up>Set-up</a></h3>

<p class=MsoNormal>There are two options for configuring your multi-database
execution. If you know all of you target databases ahead of time and want to
set them up manually, you can&nbsp;go through the UI to create the
configuration. If you need another tool to create the list or want to construct
a configuration manually, you can use a simplified, delimited version of the
configuration, one setting per line:</p>

<p class=MsoNormal>&lt;server&gt;:&lt;default database&gt;,&lt;target
database;&lt;default2&gt;,&lt;override2&gt;</p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal>The first argument is the server name, followed by a colon
     (:).</li>
 <li class=MsoNormal>Next it the first default database, override database
     configuration setting, using a comma (,) as the delimiter. (Remember, the
     default database is the database set in the SBM for the script. The
     override database is the actual database you want to execute against at
     run time.</li>
 <li class=MsoNormal>If you have additional default databases set in the SBM
     file, you will need another override setting. Separate these pairs by a
     semi-colon (;).</li>
</ul>

<p class=MsoNormal>For each database you want to execute against, add an
additional line in the configuration file (i.e. each line equates to an
additional thread). Finally, save the file with a .cfg extension</p>

<p class=MsoNormal>See <a href="#AdvancedCommandLineExecution">Advanced Command
Line Execution</a> for the command line syntax to execute your threaded builds.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name=RemoteServicsExecutionandDeployment></a><a name="_Toc273689313"></a><a
name="_Remote_Service_Execution"></a>Remote Service Execution and Deployment</h1>

</div>

<p class=MsoNormal>While the tool has the feature for <a
href="#TargetingMultipleServersandDatabases">Targeting Multiple Servers and
Databases</a>, you can take that multi-target, multi-threaded execution one
step further and distribute that load across multiple “Execution Servers” as
well. It builds on the multiple server functionality and extends it to send
build requests via a remote service call to remote computers that will handle
the actual processing of the SQL scripts. You can spit the load amongst all of
your execution servers for maximum efficiency and minimum deployment time.</p>

<h2><a name=RemoteServiceExecutionandDeploymentOvr></a><a name="_Toc273689314">Overview</a></h2>

<p class=MsoNormal style='margin-left:.25in'>To access the Remote Execution
Service form, click the <span style='font-family:"Cambria","serif"'>Action </span><span
style='font-family:Wingdings'>à</span><span style='font-family:"Cambria","serif"'>
Remote Execution</span> Service menu item. (If this menu item is not enabled,
you will need to have your <a href="#FeatureAccessSettings">user id configured</a>
by your administrator to get access)</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=276 height=311 src="SqlBuildManagerManual_files/image036.jpg"></p>

<p class=MsoNormal style='margin-left:.25in'>The remote execution form has 4
sections: </p>

<p class=MsoListParagraphCxSpFirst style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#RemoteServers"><i>Remote Servers</i></a> – this is for
the list of remote execution servers that you will be using. You can either
type into the list or use the <span style='font-family:"Cambria","serif"'>Action
</span><span style='font-family:Wingdings'>à</span><span style='font-family:
"Cambria","serif"'> Manager Server</span> Sets menu option to set up and load
pre-configured server groups. NOTE: an execution server is not necessarily a
SQL Server machine. It can be any computer or server that has the remote
execution service loaded and has connectivity to all of your target SQL
servers. </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#ExecutionSettings"><i>Execution Settings</i></a> – this
is the same as the execution settings group found on <a
href="#AutoCreationofCommandLineStatements">Command Line Builder</a> form. This
will configure which SBM package you will use, the logging path, execution
parameters and the multi-database configuration that will be used.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#WorkloadDistribution"><i>Workload Distribution</i></a>
– sets how you would like to distribute the workload across your execution
servers. The default value is “Equally Distribute…” which will do just that.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="#RemoteServiceStatusDashboard"><i>Remote Service Status
Dashboard</i></a><i> </i>– gives you a view of the status of the Sql Build
Manager Build Service on each of the execution servers. </p>

<p class=MsoListParagraphCxSpLast align=center style='text-align:center'><img
border=0 width=859 height=475 src="SqlBuildManagerManual_files/image037.png"></p>

<h3><a name=RemoteServiceExecutionandDeploymentSect></a><a name="_Toc273689315">Section
Detail</a></h3>

<h4><a name=RemoteServers>Remote Servers</a></h4>

<p class=MsoNormal>This list of remote servers that will serve as the execution
engine for your deployment can be populated in 2 ways. First, you can type in
the machine name of the servers directly into the grid. However, if you plan on
re-using server sets, you are better of creating Server Sets via the <span
style='font-family:"Cambria","serif"'>Action </span><span style='font-family:
Wingdings'>à</span><span style='font-family:"Cambria","serif"'> Manager Server
Sets</span>, menu item which will display the Remote Execution Server
Configuration window.</p>

<p class=MsoNormal><img width=214 height=94
src="SqlBuildManagerManual_files/image038.png" align=left hspace=12> <img
border=0 width=381 height=282 id="Picture 42"
src="SqlBuildManagerManual_files/image039.jpg"></p>

<p class=MsoNormal>The first step in creating a reusable configuration is to
use the Action <span style='font-family:Wingdings'>à</span> New Configuration
menu. You will be prompted for a Server Group name, pick one that makes sense
for the group of execution servers that you will be first setting up and click
“OK”. This name will show up in the left side “Server Group” section. Click on
the name to activate the right hand side setting section.</p>

<p class=MsoNormal>In the “Server Group Description” section, give yourself a
meaningful name – for instance “Development Area execution servers”. Next, add
the servers to the Remote Execution Server grid by typing in the bottom text
box of the grid. Once you have finished that group, you can add another Server
Group (a  “Production” group for instance) and add the servers for that set or
you can use the <span style='font-family:"Cambria","serif"'>Action </span><span
style='font-family:Wingdings'>à</span><span style='font-family:"Cambria","serif"'>
Save</span> menu item to save the configuration file. NOTE: the next time you
open this page, it will automatically load the last configuration you used.</p>

<p class=MsoNormal>Once you have your groups configured, to use one of them,
select it’s name in the Server Group list and click the “Use Selected Group”
button. This will close the form and add the server names to the Remote
Execution Server grid on the parent page.</p>

<h4><a name=ExecutionSettings>Execution Settings</a></h4>

<p class=MsoNormal>For a description of the common settings between this form
and the Command Line Builder form, see that <a href="#CommandLineBuilderOptions">section</a>.
There are a couple of important differences:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i>Root logging path</i> – this path must be present and
accessible on each execution server. It is best to use a local folder path on
the execution server (vs. a network share) to maximize performance and
reliability of the logging and execution. </p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i>Override Target Settings / Configuration links</i> -  the 2
links “Open Multi-Db config form” and “Create configuration via query” allow
you to create and/or preview the multi-database deployment configuration. Just
like the command line, this can be done via a pre-configured file (<a
href="#TargetingMultipleServersandDatabases">.multiDb</a> – which is an XML
formatted configuration file or .cfg which is a plain text delimited file) or
via a <a href="#CreateConfigurationviaaQuery">.multiDbQ</a> – which is a
formatted database query that can dynamically construct the configuration for
you. These links will open the appropriate configuration page. By saving the
new configuration file and closing out the form, the configuration file name
will populate in the Override Target Settings text box.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i>Derive Remote Execution Server list from Override Target
Settings </i>– this is an option you can use if your target database servers
also act as your remote execution servers. By checking this box, you direct the
tool to derive the list of unique server names from the Override Target
Settings file or query and then use this list as the Remote Execution Servers
list. NOTE: checking this box will automatically change the <a
href="#WorkloadDistribution">Workload Distribution</a> to <i>Each execution
server handles only its local load (matches host names). </i>You can change the
selection if you’d prefer however.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=602 height=215 src="SqlBuildManagerManual_files/image040.png"></p>

<h4><a name=WorkloadDistribution>Workload Distribution</a></h4>

<p class=MsoNormal>To take advantage of the multiple execution servers, you
need to distribute the load to each of them, further distributing the
processing of the SQL scripts. This can be managed in 2 ways:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i>Equally distribute load across execution servers</i> – simple
enough. It will take the load, split it as equally as possible across all of
the servers. The split is done by chunking out into approximately equal parts.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i>Each execution server handles only its local load (matches
host names) – </i>this option should only be used if you double task your server
not only as a SQL Server host, but also a remote execution host. This will tell
the distributor to do a match between the execution server name and the server
name of the target database. It will only task the execution server with
positive matches. </p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=799 height=70 id="Picture 48"
src="SqlBuildManagerManual_files/image041.png"></p>

<p class=MsoNormal>Because work is being distributed and/or matched to
execution servers, there is the potential that the workload could be unbalanced
and/or database could be missed altogether. To give the user insight into this,
once a SBM build file and Override Target Setting values have been provided,
the “Preview Distribution” button becomes enabled. This will have the tool do a
dry run at splitting up the workload and display for you how it will be managed
as well as any databases that will be skipped and execution servers that would
be un-tasked.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=432 height=287 id="Picture 33"
src="SqlBuildManagerManual_files/image042.jpg"></p>

<h4><a name=RemoteServiceStatusDashboard>Remote Service Status Dashboard</a></h4>

<p class=MsoNormal>This report the status of the execution servers you have
configured in the <a href="#RemoteServers">Remote Servers</a> section. It is
populated by clicking the “Check Service Status” button.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=856 height=89 src="SqlBuildManagerManual_files/image043.png"></p>

<p class=MsoNormal>The 6 status columns are:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Server Name – you guessed it, the name of the execution server.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Service Readiness – tells you the status of the service on that
machine. The possible values are:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>ReadyToAccept – the service is at your beckon call and ready to
go.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>PackageAccepted – you have submitted a package and it is
undergoing setup.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>PackageValidationError  - there is something wrong with the
package and it could not be processed</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Processing – hmm. Yes, it’s doing your work for you</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Error – something bad has happened. </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Unknown – the service isn’t properly reporting a status. </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Unreachable – the service can’t be contacted – is the service
running?</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>ProcessingCompleted – the job is done and the processor is
completing it’s clean-up</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Last Status Check – the last time the client attempted to contact
the service for a status update</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Last Execution Result – since the remote service has been
started, what was the result of the last execution. If nothing has been run
since the service start, it will report “Waiting”. Otherwise you will most
often see:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Successful – self explanatory</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>FinishingWithErrors – the processing completed, some databases
were probably updated, but some have experienced a problem. You can check which
ones via the <a href="#ServiceStatusContextMenu">service status context menu</a>.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Service Version – just to make sure you’re services are all in
sync, this is the program version of each execution service. </p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Tcp Service Endpoint – the Sql Build manager talks to the remote
execution servers via a TCP connection. This tells you what the URL and
communication port are for the service. This is used mostly for
troubleshooting. </p>

<h4><a name=ServiceStatusContextMenu>Service Status Context Menu</a></h4>

<p class=MsoNormal align=center style='text-align:center'>To view the details
of the last execution, you can right click on a cell in the <a
href="#RemoteServiceStatusDashboard">Remote Service Status Dashboard</a> to
pull up the context menu. In this menu you have five options: <img border=0
width=411 height=138 id="Picture 20"
src="SqlBuildManagerManual_files/image044.png"></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>View Last Execution “Errors” log – this will display the error
log from the selected row’s target server. This log displays the list of
servers for which execution was not successful.</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=534 height=133 id="Picture 60"
src="SqlBuildManagerManual_files/image045.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>View Last Execution “Commits” log – this will display the commits
log from the selected row’s execution server. This log displays the list of
servers for which execution was successful.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Paste Server/Database value below to retrieve detailed log for
last run – this is a very long winded label, but you get the idea. You can take
the target database/server from the errors or commits log (pixilated above for
your protection), paste it in here and the execution service will send back the
detailed execution log specifically for that database. In that log, you should
see exactly what happened with the run. </p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>View Remote Service Executable Log file – the remote service
agent keeps a running log of errors and warnings that may be useful to
determine what caused an issue with an execution – especially if the error is
not SQL related. This menu item will pull the contents of that log file into a
display window for you, so you don’t need to login to that machine directly</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>View Build Request History for this Remote Service – as of
version 8.5.8, the agents will keep a history of accepted build requests. This
menu item will display information about these requests. From this new window,
you will also be able to use the context menu to pull back the log files for
each specific execution.</p>

<p class=MsoListParagraphCxSpLast align=center style='text-align:center'><img
border=0 width=770 height=142 id="Picture 26"
src="SqlBuildManagerManual_files/image046.png"></p>

<h2 style='margin-top:0in'><a name=Pretestingdatabaseconnectivity></a><a
name="_Toc273689316">Pre-testing database connectivity</a></h2>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Once you
have added or loaded your list of <a href="#RemoteServers">Remote Execution
Servers</a> and also set your Override Target Settings value, the application
has enough information to be able to pre-test the remote execution server’s
agent ability to connect to its designated database targets. This pre-test is
not required, but may highlight connectivity issues prior to you actually
executing a full build.  </p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>To execute
the test, just click the “Test Connections” button and the application will
instruct the remote execution servers to make a connection (don’t worry, no
scripts will be run). If all connections as successful, you will get a simple
pop-up message confirming this. If there are connection issues, you will get a
pop-up listing the remote execution server name, the SQL Server name and the
database name where the connection could not be made.</p>

<p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
text-align:center'><img border=0 width=227 height=78
src="SqlBuildManagerManual_files/image047.png"></p>

<h2><a name="_Toc273689317">Performing a remote execution</a></h2>

<p class=MsoNormal>Below is a step-by-step how-to for running a remote
execution and deployment. For details about each section and its function see
above in the Remote Execution and Deployment <a
href="#RemoteServiceExecutionandDeploymentOvr">overview</a> and <a
href="#RemoteServiceExecutionandDeploymentSect">section detail</a></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Open
the Remote Execution Service From</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Type
in or <a href="#RemoteServers">load list</a> or Remote Execution Servers that
you will be tasking with your deployment.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Click
the “Check Service Status” button. This will have the Sql Build Manager call
out to the specified servers and see if they’re ready to go.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Type
in your Root Logging Path – remembering that this is going to be a local path
that will reside on each execution server. You can use System Environment
variables in the path to make is more customizable.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Type
in a Build Description – a “serial number” or description of why you’re
performing the build</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Select
a Script Source – your SMB build package. You can either type in the path or
use the “Open” button to navigate to it. </p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Select
an Override Target Settings value – your pre-defined .multiDb, .multiDbQ or
.cfg file. You can also create a new one with either the “Open Multi-Db config
form” or “Create configuration via query” link buttons.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>8.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Optionally,
you can change your authentication settings and the Alternate Logging Database
values. </p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Next,
select your workload distribution so tell the tool how you want to spread the
work across your servers. </p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>10.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Optionally, but a good
idea, click the “Preview Distribution” button. This will display the
“Calculated Execution Distribution” form so you can ensure that all servers and
databases will be tasked and updated.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>11.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Finally, click the
“Submit Build Request” button. This will send the distributed load to the
execution servers for work. While processing is going, Sql Build Manager will
automatically query each of the execution servers 2 times a second to update
the Service Readiness and Last Execution Result values.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>12.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Once all services
report back a status of “ReadyToAccept”, the auto polling will stop.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>13.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>If any of the
execution servers reports a “FinishingWithErrors”, you should check the results
via the “View Execution ‘Errors’ Log” and the detailed log results to see how
you can mediate and correct the problems.</p>

<p class=MsoNormal>For a command line execution across multiple servers, see the
<a href="#AdvancedCommandLineExecution">Advanced Command Line Execution</a>
section below.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name="_Toc273689318"></a><a name=AdvancedCommandLineExecution>Advanced
Command Line Execution</a></h1>

</div>

<h2><a name="_Toc273689319"></a><a name=Execution>Executio</a>n Flags</h2>

<p class=MsoNormal>To run your multithreaded build or remote server execution,
you need to use the SqlBuildManager.Console.exe utility with the command line
options:</p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/threaded=true</span>&nbsp;This is the key
     flag to alert the utility that you will be executing this SBM file in a
     multi-threaded mode. This flag is used exclusively for the threaded mode.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/build=&quot;&lt;.sbm file name&gt;&quot;</span>&nbsp;<br>
     Lets the tool know that you want to run a Sql Build using the specified
     .sbm file. This is not used alone, but in conjunction with a <span
     style='font-size:10.0pt;line-height:115%;font-family:"Courier New";
     color:#632423'>/server</span> and/or a <span style='font-size:10.0pt;
     line-height:115%;font-family:"Courier New";color:#632423'>/override</span>
     argument.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/ScriptSrcDir=&quot;&lt;directory
     path&gt;&quot;</span><br>
     Alternatively, if you want to run your scripts from a directory instead of
     a pre-constructed SBM file, you can use this option. Set the value to the
     directory where your scripts are located. The engine will look for all
     files with a&nbsp;.sql&nbsp;extension and sort them by file name. They
     will be configured to leave transactions with full rollback on failure. If
     this and a&nbsp;/build&nbsp;tag are found, this will be used. Also, since
     the files will be added without a default database setting, the engine
     will use the first override database setting per line in the config file</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/override=&quot;&lt;.multiDb file
     name&gt;&quot;&nbsp;or&nbsp;/override=&quot;&lt;.cfg file name&gt;&quot;</span><br>
     Sets the&nbsp;pre-configured multi database/server configuration&nbsp;or
     the text delimited configuration to be used along with the .sbm file for
     the build run.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/RootLoggingPath=&quot;&lt;directory
     name&gt;&quot;</span>&nbsp;Sets the root directory under which all of the
     log files and folders will be placed. This flag is used exclusively for
     the threaded mode. Note that you may use environment variables in this
     path to make value more dynamic per system.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/trial=&lt;true or false&gt;</span>&nbsp;By
     default, the threaded execution will commit the changes to the target
     databases. If you want to experiment with the run to check how it will go,
     you can set the trial tag to&nbsp;true. This will work the same as the
     trial mode in the UI and roll back the changes in each database, even upon
     successful completion. To keep things more simple, the successful runs are
     still added to the&nbsp;Commits&nbsp;log file but are recorded as
     &quot;Build Successful. Trial Rolled-back&quot;</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/LogAsText=&lt;true or false&gt;.</span> Be
     default, the value is false, which will create the Commits and Errors log
     files in HTML. The advantage of this is that it will hyperlink you to the
     appropriate folder for viewing error or execution log details. If you set
     the value to true, the same information will be written, just in plain
     text.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/username=&quot;&lt;user name&gt;&quot;</span>&nbsp;The
     user name for a SQL Server user account that you want to execute under. If
     this tag is present, then a&nbsp;/password&nbsp;tag is also required. If
     these tags are not present, the tool will use Windows authentication when
     connecting to the database.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/password=&quot;&lt;password&gt;&quot;</span>&nbsp;The
     password for the SQL Server user account that you want to execute under.
     If this tag is present, then a&nbsp;/username&nbsp;tag is also
     required.&nbsp;If these tags are not present, the tool will use Windows
     authentication when connecting to the database.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/LogToDatabaseName=&quot;&lt;alternate
     database&gt;&quot;</span>&nbsp;Allows you to write the commit logs to
     the&nbsp;SqlBuild_Logging&nbsp;table on a different database than the
     target databases. This should be used sparingly as it will not give you
     the proper script status when opened in the user interface</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/description=&quot;&lt;run
     description&gt;&quot;</span>&nbsp;Allows you to add a custom description
     to the run. This will be used in the same fashion as a description added
     during a serial/manual run. This will also be used as the token
     replacement for any dynamic scripts you have. The token for this value
     is&nbsp;<span style='font-size:10.0pt;line-height:115%;font-family:"Courier New";
     color:#632423'>#BuildDescription#</span></li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/Transactional</span><span style='font-size:
     10.0pt;line-height:115%;font-family:"Courier New";color:#632423'>=&lt;true
     or false&gt; </span>Allows you to run the scripts without transactional
     protection. WARNING! Using this setting will mean that if a script fails,
     all previous scripts will still be committed and your databases will be
     left in an inconsistent state</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/TimeoutRetryCount=&lt;positive integer
     number value&gt; </span>Sets the ability to have the package be
     automatically re-run “x” number of times if the SQL Server exception
     encountered is “Timeout expired”. This is not valid in combination of <span
     style='font-size:10.0pt;line-height:115%;font-family:"Courier New";
     color:#632423'>/Transactional=false</span></li>
</ul>

<p class=MsoNormal>The following keys are used exclusively for <a
href="#RemoteServiceExecutionandDeploymentOvr">Remote Server Execution</a>. See
this section above for the UI version and explanation of this functionality.
Unless noted, the above <a href="#Execution">Execution Flags</a> can also be
used to configure the run.  For ease of use and to help you create a properly
formed command-line string, there is now a “Create Command Line” button
available – but be aware that while this does create a well formed string it
does NOT validate the values or files and therefore does not guarantee
execution success.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=612 height=83 src="SqlBuildManagerManual_files/image048.png"></p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/remote=true </span>This is the key flag to
     alert the utility that you will be distributing execution to remote
     execution servers. This key should <i>not</i> be combined with the <span
     style='font-size:10.0pt;line-height:115%;font-family:"Courier New";
     color:#632423'>/threaded </span>flag. </li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/RemoteServers=”&lt;remote server file&gt;” </span>This
     defines the file to use that defines the remote execution servers that
     will be used for this run. This file should be a simple text file that
     contains one machine name per line.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/RemoteServers=”derive” </span>This is an
     advanced setting that you can use if your target database servers also act
     as your remote execution servers. This instructs the tool to derive the
     unique server names from the <span style='font-size:10.0pt;line-height:
     115%;font-family:"Courier New";color:#632423'>/override</span> settings
     and use that list as the remote server list.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/DistributionType=equal </span>or<span
     style='font-size:10.0pt;line-height:115%;font-family:"Courier New";
     color:#632423'> /DistributionType=local </span>Defines how the load for
     the execution will be split across the execution servers. For details, see
     the <a href="#WorkloadDistribution">Workload Distribution</a> section.</li>
</ul>

<h2><a name="_Toc273689320"></a><a name=Logging>Logging</a></h2>

<p class=MsoNormal>Since there isn't a user interface for this type of
execution, logging is obviously important. For general logging, the
SqlBuildManager.Console.exe has its own local messages. This log file is named <span
style='font-size:10.0pt;line-height:115%;font-family:"Courier New"'>SqlBuildManager.Console.log</span>
and can be found in the same folder as the executable. This file will be the
first place to check for general execution errors or problems.</p>

<p class=MsoNormal>To accommodate the logging of the actual build, all of the
output is saved to files and folders under the path specified in the&nbsp;<span
style='font-size:10.0pt;line-height:115%;font-family:"Courier New";color:#632423'>/RootLoggingPath&nbsp;</span>flag.
For a simple threaded execution, this is a single root folder. For a remote
server execution, this folder is created for each execution server. </p>

<p class=MsoNormal style='margin-left:.5in'><a name=Workingfolder><b>Working
folder</b></a></p>

<p class=MsoNormal style='margin-left:.5in'>This folder is where the contents
of the .SBM file are extracted. This file is extracted only once and loaded
into memory for the duration of the run to efficiently use memory.</p>

<p class=MsoNormal style='margin-left:.5in'><a name=Commits.log><b>Commits.html
(or .log for text scripting)</b></a></p>

<p class=MsoNormal style='margin-left:.5in'>Contains a list of all databases
that the build was committed on. This is a quick reference for each location
that had a successful execution.</p>

<p class=MsoNormal style='margin-left:.5in'><a name=Errors.log><b>Errors.log
(or .log for text scripting)</b></a></p>

<p class=MsoNormal style='margin-left:.5in'>Contains a list of all databases
that the build failed on and was rolled back. This is a quick reference for all
locations that had failures.</p>

<p class=MsoNormal style='margin-left:.5in'><a name="Server/Databasefolders"><b>Server/Database
folders</b></a></p>

<p class=MsoNormal style='margin-left:.5in'>For each server/database
combination that was executed, a folder structure is created for each server
and a subfolder in those for each database. Inside each database level folder
will be three files:</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in'><span
style='font-size:10.0pt;line-height:115%;font-family:Wingdings'>§<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:115%;font-family:"Courier New"'>LogFile-&lt;date,time&gt;.log</span>:
This is the script execution log for the database. It contains the actual SQL
scripts that were executed as well as the return results of the execution. This
file is formatted as a SQL script itself and can be used manually if need-be.</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in'><span
style='font-size:10.0pt;line-height:115%;font-family:Wingdings'>§<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:115%;font-family:"Courier New"'>SqlSyncBuildHistory.xml</span>:
the XML file showing run time meta-data details on each script file as executed
including run time, file hash, run order and results.</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in'><span
style='font-size:10.0pt;line-height:115%;font-family:Wingdings'>§<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:115%;font-family:"Courier New"'>SqlSyncBuildProject.xml</span>:
the XML file showing the design time meta-data on each script file that defined
the run settings, script creation user ID's and the committed script record and
hash for each.</p>

<h2><a name=CommandLineReturnCodes></a><a name="_Toc273689321">Command Line
Return Codes</a></h2>

<p class=MsoNormal>&nbsp;</p>

<h3><a name="_Toc273689322">Execution Result codes</a> </h3>

<p class=MsoNormal>These are the codes that may be returned by the
SqlBuldManager.Console.exe file to the originating command. Any non-zero result
is an error.</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>0  - Successful execution</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>1 – The execution finished however there was an error on one or
more target databases. You should check the <span style='font-size:10.0pt;
line-height:115%;font-family:"Courier New"'>errors.log</span> file for details.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-99  - The <span style='font-size:10.0pt;line-height:115%;
font-family:"Courier New"'>/RootLoggingPath</span> flag is missing. This is
required for threaded and remote server executions.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-100 – The <span style='font-size:10.0pt;line-height:115%;
font-family:"Courier New"'>/override</span> flag is missing</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-101 – The <span style='font-size:10.0pt;line-height:115%;
font-family:"Courier New"'>/build</span> flag is missing. This is required to
define the .SBM file that is to be executed.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-102 – The <span style='font-size:10.0pt;line-height:115%;
font-family:"Courier New"'>/override</span> flag has an incorrect value</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-103 – The .SBM file was invalid.  The application was not able
to load the .SBM file</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-104 – The MultiDb configuration file was invalid. The
application was not able to load the .<span style='font-size:10.0pt;line-height:
115%;font-family:"Courier New"'>MultiDb, .MultiDbQ </span>or<span
style='font-size:10.0pt;line-height:115%;font-family:"Courier New"'> .cfg</span>
file </p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-size:10.0pt;line-height:115%;font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-105 – A <span style='font-size:10.0pt;line-height:115%;
font-family:"Courier New"'>/ScriptSrc </span>flag was found, but the specified
path was not found.<span style='font-size:10.0pt;line-height:115%'> </span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-106 – The .SBM file defined in the <span style='font-size:10.0pt;
line-height:115%;font-family:"Courier New"'>/build</span> flag was not found</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-107 – An invalid <span style='font-size:10.0pt;line-height:115%;
font-family:"Courier New"'>/transactional</span> and <span style='font-size:
10.0pt;line-height:115%;font-family:"Courier New"'>/trial</span> flag
combination was found. A run cannot be <span style='font-size:10.0pt;
line-height:115%;font-family:"Courier New"'>/trial=true and
/transactional=false</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-108 – Upon loading the multi-database configuration, a missing
default value or target override setting was found. This needs to be corrected
for the scripts to run.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-109 – Negative <span style='font-size:10.0pt;line-height:115%;
font-family:"Courier New"'>/TimeoutRetryCount</span>  value. This flag must be
set to a positive integer balue</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-110 –  An invalid <span style='font-size:10.0pt;line-height:
115%;font-family:"Courier New"'>/transactional</span> and <span
style='font-size:10.0pt;line-height:115%;font-family:"Courier New"'>/</span><span
style='font-size:10.0pt;line-height:115%;font-family:"Courier New"'>TimeoutRetryCount</span>
 flag combination was found. A run cannot be set with <span style='font-size:
10.0pt;line-height:115%;font-family:"Courier New"'>/</span><span
style='font-size:10.0pt;line-height:115%;font-family:"Courier New"'>TimeoutRetryCount</span><span
style='font-size:10.0pt;line-height:115%;font-family:"Courier New"'>=(anything
&gt;0) and /transactional=false</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-200 – The .SBM file scripts were not extracted properly. </p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-201 - The .SBM file was not in the proper format. The data was
not loaded</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-300 – Run initialization error. Unable to configure runtime data</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-301 – Build processing error. A particular execution thread
encountered an error. Check the <span style='font-size:10.0pt;line-height:115%;
font-family:"Courier New"'>errors.log</span> file for details.</p>

<p class=MsoNormal style='margin-left:.25in'>Remote server execution specific
error codes</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-600 – Unable to create a Build Settings object from specified
command line arguments</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-601 – One or more of the remote execution servers encountered an
error in execution</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-700 – The <span style='font-size:10.0pt;line-height:115%;
font-family:"Courier New"'>/RemoteServers</span> flag is missing</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-701 –   The <span style='font-size:10.0pt;line-height:115%;
font-family:"Courier New"'>/RemoteServers</span> flag is invalid. This must
refer to an existing file.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-702 – The <span style='font-size:10.0pt;line-height:115%;
font-family:"Courier New"'>/DistributionType</span> flag is missing.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-703 – The <span style='font-size:10.0pt;line-height:115%;
font-family:"Courier New"'>/DistributionType</span> flag value is invalid.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-750 – One or more of the specified remote execution servers did
not return a “Ready to Accept” status message</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-751 – Unable to connect to one or more of the specified remote
execution servers.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>-752 – No remote execution servers were specified</p>

<p class=MsoNormal>        </p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name=AdvancedScriptHandling></a><a name="_Toc273689323">Advanced Script
Handling</a></h1>

</div>

<h2><a name="_Toc273689324">Utility Scripts</a></h2>

<p class=MsoNormal>To assist you in creating robust, re-runable scripts, Sql
Build Manager comes with an array of “utility scripts” that will allow you to
insert commonly used, customized script snippets into your script file. For
instance, let’s say you need to write a script to add to a column to a table.
What is the best way to write that script? Sql Build Manager knows!</p>

<h3><a name="_Toc273689325"></a><a name="_Utility_Script_Example"></a>Utility
Script Example</h3>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Right
click on the Build Script list and select “<span style='font-family:"Cambria","serif"'>Add
New Sql Script (Text)</span>” menu item (you can also use the Ctrl+N hot key)</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=392 height=162 src="SqlBuildManagerManual_files/image049.png"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
“Add Sql Script Text” window will pop up. In this window, right click in the
main script window to pull up the utility script context menu. Since we’re
adding a column, pick the “<span style='font-family:"Cambria","serif"'>Columns</span>”
menu, then the “<span style='font-family:"Cambria","serif"'>Add Column</span>”
option.</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=488 height=264 src="SqlBuildManagerManual_files/image050.jpg"></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
<span style='font-family:"Cambria","serif"'>Utility Script Replacements</span>
window will display. Since we picked <span style='font-family:"Cambria","serif"'>Add
Column</span>, the fields required to define a new column. The <span
style='font-family:"Cambria","serif"'>scratch pad</span> area is the contents
of your clipboard. This can be handy if you have some snippet you want easy
access to. Next, fill in the column definition for the required fields. As a
short cut, you can highlight text in your scratchpad area and press the
function key associated with the textbox you want to fill.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=521 height=284 src="SqlBuildManagerManual_files/image051.jpg"></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Once
you have filled in your definition, click the <span style='font-family:"Cambria","serif"'>Submit</span>
button. This will close the <span style='font-family:"Cambria","serif"'>Utility
Scripts Replacements</span> window and insert the newly created script into the
body of the <span style='font-family:"Cambria","serif"'>Add SQL Script Window. 
</span>A couple of notable features are added. First, a default name was added
to the script name box. This name is dependent on the type of action you
performed. Here for instance it gives you a name describing the addition of a
column. Also of note the script that was created is “wrapped” in select against
the database to see if the column already exists in the database. This allows
you to commit the script multiple times without worrying about getting an error
that the column already exists</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=706 height=314 src="SqlBuildManagerManual_files/image052.jpg"></p>

<p class=MsoListParagraphCxSpLast>&nbsp;</p>

<h3><a name="_Toc273689326"></a><a name="_Simple_Text_Inserts"></a>Simple Text
Inserts</h3>

<p class=MsoNormal>Some of the utility options don’t do much other than insert
simple, commonly used pieces of SQL. </p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><strong><span style='font-family:"Calibri","sans-serif"'>WITH
NOCHECK ADD – (string literal)</span></strong> : this does just that, adds the
text WITH NOCHECK ADD at the location of your cursor. Handy when working with
Foreign Keys.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>WITH (NOLOCK) – (string literal)</b> : adds the text WITH
(NOLOCK) at the location of your cursor. Handy when working with scripts that
have selects against tables that can afford the potential for a “dirty read”</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Insert Comment Header: </b>adds a comment header block to your
script at the location of your cursor. Great for ensuring consistency in your
procedure and function definitions.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=334 height=84 src="SqlBuildManagerManual_files/image053.png"></p>

<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:
Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Grant Database Permissions: </b>Adds a rather large script to
iterate through your target database and grant permissions to all of your
stored procedures and functions to a specified list of user groups. </p>

<h3><a name="_Toc273689327">Token Replacements</a></h3>

<p class=MsoNormal>A canned search and replace function.</p>

<p class=MsoListParagraph style='text-indent:-.25in'><span style='font-family:
Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>CREATE </b><b><span style='font-family:Wingdings'>à</span>
ALTER: </b>This will search all the text you have highlighted for the word
CREATE (case insensitive) and replace it with ALTER.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=334 height=38 id="Picture 17"
src="SqlBuildManagerManual_files/image054.png"></p>

<h3><a name="_Toc273689328"></a><a name="_Script_Creation"></a>Script Creation</h3>

<p class=MsoNormal>These utilities will help you create your scripts from
scratch. You don’t need to know the syntax for any of the scripts, just fill in
the form and the scripts are created for you. The example above in <a
href="#_Utility_Script_Example">Utility Script Example</a> is a sample of a
script creation utility. The others are found in the sub-menu for their object
type. All of these scripts will contain the “IF EXISTS” or “IF NOT EXISTS”
wrapping to ensure they are fully re-runable. </p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=318 height=237 id="Picture 41"
src="SqlBuildManagerManual_files/image055.png"></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Columns</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Add Column: As above, generates a script to add a column to a
table</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Alter Column: Creates a script to alter a column on a table</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Delete Column: Creates a script to delete a column from a table</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Rename Column: Creates a script to rename a column. This is a
pretty complex one, very useful if you are going to rename</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Foreign Keys</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Drop Single Foreign Key: Creates a script to drop a foreign key
from a table</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Drop All Foreign Keys: Creates a script to drop all of the
foreign keys associated with a table. Another pretty complex script.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Default Constraints</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Add Default Constraint: Creates a script to add a default value
to an existing column in an existing table.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Drop Default Constraint: Creates a script to drop a default
constraint on a column. Use this when you know the name of the constraint
already</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Drop Column Default Constraint: Creates a script to drop a
default constraint on a column when you don’t know the name of the constraint.
This is useful when you had created a constraint without specifying a name and
let SQL server name it for you with a random name.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Triggers</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Drop Trigger: Drops a trigger from the database</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Disable Trigger: Creates a script to disable an existing  trigger
on a database table</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Enable Trigger: Creates a script to enable an existing trigger on
a database table</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Tables</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Drop Table: Creates a script to drop a table. </p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Indexes</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Add Index: Creates a script to add a standard index (non-unique,
non-clustered) to a table. Specify a comma delimited list of columns. </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Add Unique Index: Creates a script to add a unique index to a
table. Specify a comma delimited list of columns. </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Add Non-Clustered Index: Creates a script to add a non-clustered
index to a table. Specify a comma delimited list of columns. </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Drop Index: Creates a script to drop an existing index </p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Stored Procedures</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Drop Stored Procedure: Creates a script to drop a stored
procedure from the database.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Grant Execute to Stored Procedure: Creates a script to grant the
EXECUTE permission to a specified user to stored procedure</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Revoke Execute to Stored Procedure: Creates a script to revoke
the EXECUTE permission to a specified user to stored procedure</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Functions</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Drop Function: Creates a script to drop a function from the
database.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Grant Execute to Function: Creates a script to grant the EXECUTE
permission to a specified user to function</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Revoke Execute to Function: Creates a script to revoke the
EXECUTE permission to a specified user to function</p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in'><b>&nbsp;</b></p>

<h3><a name="_Toc273689329"></a><a name="_Script_Wrappers"></a>Script Wrappers</h3>

<p class=MsoNormal>These are utility scripts that will take a script you
already have and put it in an IF EXISTS or IF NOT EXISTS wrapper. These help
you create more robust scripts that perform pre-checks around your change to
limit the number of failures and roll-back changes you have as you run the
scripts across your environments. Like the <a href="#_Script_Creation">script
creation</a> utility scripts, these are found in the sub-menu items for the
object type.</p>

<p class=MsoListParagraph style='text-indent:-.25in'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Add your custom script to the script form. Highlight the script (or
portion of) that you want to be wrapped, then select the appropriate object
wrapper selection</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=617 height=306 id="Picture 29"
src="SqlBuildManagerManual_files/image056.jpg"></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
utility window will open up. Notice that your highlighted text has been added
to the scratchpad. Also notice that the checkbox “Insert Scratch Pad Values” is
checked  - this setting means that the text in the scratchpad will be inserted
inside the  wrapper. Fill out the form and click submit.</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=453 height=214 id="Picture 35"
src="SqlBuildManagerManual_files/image057.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
utility window will close and your highlighted text with be overwritten with
the  updated “wrapped” script</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=742 height=72 src="SqlBuildManagerManual_files/image058.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Columns</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>IF NOT EXISTS…Column: Puts a wrapper around a script to ensure
that a column doesn’t exist on a table prior to running the enclosed script.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>IF EXISTS…Column: Puts a wrapper around a script to ensure that a
column does exist on a table prior to running the enclosed script.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Primary Keys</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Wrap Add Primary Key: Checks to make sure a primary key does not
exist before running the enclosed Primary Key add script.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Triggers</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Wrap Add Trigger:  Adds a script header to check if a trigger is
pre-existing. If yes, then the trigger is dropped. Your create script is then
added after this wrapper.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Tables</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Wrap Add Table: Checks to make sure the table you are adding does
not pre-exist in the table. If not, it falls into your add script.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Indexes</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Wrap Add Index: Checks to make sure an index on a specific table
does not exist prior to running your enclosed script.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Wrap Alter Index:  Checks to make sure an index on a specific
table does exist prior to running your enclosed script.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Stored Procedures</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Wrap Add/Alter Stored Procedure: Adds a script header to check if
the stored procedure is pre-existing. If yes, then the stored procedure is
dropped. Your script is then added after this wrapper.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Functions</b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span>Wrap Add/Alter Function: Adds a script header to check if the
function is pre-existing. If yes, then the function is dropped. Your script is
then added after this wrapper.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>IF EXISTS…Object</b>: Creates a generic query against
sysobjects to see if the specified object and type exist. If it does, it will
run your enclosed script</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>IF NOT EXISTS…Object</b>: Creates a generic query against
sysobjects to see if the specified object and type exist. If it does not, it
will run your enclosed script</p>

<p class=MsoListParagraphCxSpLast>&nbsp;</p>

<h3><a name="_Toc273689330">Script Manipulation and Optimization</a></h3>

<p class=MsoNormal>There are several built in routines that will modify your
scripts to perform specific functions. </p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=331 height=87 id="Picture 44"
src="SqlBuildManagerManual_files/image059.png"></p>

<h4>Optimize SELECT : Add “WITH (NOLOCK)” Directive</h4>

<p class=MsoNormal>This routine scans through your script (just your selected
section or the entire contents if nothing is selected) and will add a WITH
(NOLOCK) directive to all of your table select scripts. This is a very
important directive to add to your scripts (especially stored procedures and
functions) to improve performance. NOTE: this should only be used when a dirty
read is acceptable: reports and displays for instance, but not on important
transactional selects. </p>

<h4>Convert to ALTER COLUMN</h4>

<p class=MsoNormal>This will take a simple CREATE TABLE script or selection of
column definitions and modify it to a series of ADD/ALTER column.</p>

<p class=MsoListParagraph style='text-indent:-.25in'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Add your CREATE TABLE script to the script window (or just the column
definition sections) and highlight it. Right-Click and select the “<span
style='font-family:"Cambria","serif"'>Convert to ALTER COLUMN</span>” menu
option</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=601 height=62 id="Picture 50"
src="SqlBuildManagerManual_files/image060.png"></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
program will run through its processing and produce the altered script
containing an IF EXISTS wrapper to ALTER or ADD the defined columns.</p>

<p class=MsoListParagraphCxSpLast align=center style='text-align:center'><img
border=0 width=778 height=116 id="Picture 53"
src="SqlBuildManagerManual_files/image061.jpg"></p>

<h4>Transform to resync TABLE</h4>

<p class=MsoNormal>This routine will make sure that a table in all of your
environments match the schema of the table you have scripted. The script
created will first make sure that the specified table exists (it not, it will
create it) then perform an ADD or ALTER column script for each column you have
defined. Finally (and this is the part to be very aware of), it will iterate
through the rest of the table schema and DROP any columns that you didn’t have
defined. This leaves you with the potential for data loss.</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Add
your CREATE TABLE script to the script window and highlight the text. Next,
Right-Click and select the “<span style='font-family:"Cambria","serif"'>Transform
to resync TABLE</span>” menu option.</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=576 height=111 id="Picture 59"
src="SqlBuildManagerManual_files/image062.png"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>You
will be presented with a warning message, just to make sure you are aware of
the risks and what will be created</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=426 height=112 id="Picture 62"
src="SqlBuildManagerManual_files/image063.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Clicking
“Yes” will process the script and produce the re-sync results.</p>

<p class=MsoListParagraphCxSpLast align=center style='text-align:center'><img
border=0 width=588 height=244 id="Picture 65"
src="SqlBuildManagerManual_files/image064.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<h2><a name=ScriptPolicyChecking></a><a name="_Toc273689331">Script Policy
Checking</a></h2>

<p class=MsoNormal>The Sql Build Manager will perform checks against your
scripts at you save them or script them from the database. These are designed
to ensure that you have robust, repeatable scripts that are efficient and
optimized. If a script does not pass one or more policy checks message box
describing the violation will display. The user does have the ability to ignore
the warning and continue on if they choose to do so. </p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=641 height=208 src="SqlBuildManagerManual_files/image065.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<h3><a name=ManualPolicyCheckingofBuildPackage></a><a name="_Toc273689332">Manual
Policy Checking of Build Package</a></h3>

<p class=MsoNormal>In addition to policy checking when first adding or saving a
script in the Sql Build Manager project, you can also run the policy checks
against the entire contents of the package at once. This is accomplished via
the <span style='font-family:"Cambria","serif"'>Tools </span><span
style='font-family:Wingdings'>à</span><span style='font-family:"Cambria","serif"'>
Script Policy Checking</span> menu option</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=285 height=187 src="SqlBuildManagerManual_files/image066.jpg"></p>

<p class=MsoNormal>This will present you with the Script Policy Checking
window. This window gives you the list of available policies and a description
of each. Be default, all of the policies are checked, but you can uncheck any
that you don’t want to run this time. Next, click the “Execute Policy Checks”
buttons and the results will appear in the bottom list. By default, failures
are sorted at the top of the list. To correct violations, you can double click
on the script name in this list to open an edit window.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=570 height=204 src="SqlBuildManagerManual_files/image067.jpg"></p>

<h3><a name="_Toc273689333">Grant Execute Policy</a></h3>

<p class=MsoNormal>This policy checks all of your stored procedures and
functions to ensure that they include at least one <span style='font-family:
"Cambria","serif"'>GRANT EXECUTE ON &lt;routine&gt; TO &lt;user or role&gt; </span>statement
at the end. This is designed to ensure that proper privileges are granted to
the routines so that there will not be permission problems when you deploy
them.</p>

<h3><a name="_Toc273689334">Grant Execute to [public] Policy</a></h3>

<p class=MsoNormal>Be default, SQL Server has a <span style='font-family:"Cambria","serif"'>public</span>
role. In most cases where security is a concern, you don’t want to use this
role, but rather want to create one that has only the rights that you specify.
This policy looks to see if there is a <span style='font-family:"Cambria","serif"'>GRANT
EXECUTE ON &lt;routine&gt; TO [public</span>] statement in your script and
warns you if there is.</p>

<h3><a name="_Toc273689335">WITH (NOLOCK) Policy</a></h3>

<p class=MsoNormal>In order to ensure peak performance of your database and
limit the number of locks and deadlock potential, most SELECT queries can be
run without locks (i.e. by specifying WITH (NOLOCK) for the table). To make
sure you don’t forget to add these statements, this policy validates that each
table you select against has this directive. Of course, there will be cases
where you need to let the database take a lock, so to accommodate this, you can
instead add a token to your scripts that provide an exception to the scripts:  <span
style='font-family:"Cambria","serif"'>[NOLOCK Exception: &lt;reason description&gt;].</span>
By adding this tag you tell the policy handler that you have purposely left out
NOLOCK directives and so the policy check should not fail.</p>

<h3><a name="_Toc273689336">Re-runable Script Policy</a></h3>

<p class=MsoNormal>A robust script is one that won’t fail if it’s run more than
once in the same environment. In other words, it check to see if there is an
unacceptable condition prior to being executed. In SQL, this is usually
accomplished by adding an IF EXISTS or IF NOT EXISTS wrapper or header to your
script. To aid you in doing this, the program provides methods to create these
for you (see <a href="#_Script_Creation">Script Creation</a> and <a
href="#_Script_Wrappers">Script Wrappers</a>). If also provides a policy check
to make sure that there is at least one of these checks in your script. NOTE:
This is not a fool-proof guarantee that your scripts are truly re-runable, but
rather a quick check to see if there is a statement included.</p>

<h3><a name="_Toc273689337">Qualified Table Names Policy</a></h3>

<p class=MsoNormal>For improved performance in SQL server, you should make sure
that your objects have their schema qualifier when you reference them.
&lt;schema&gt;.&lt;table&gt; This may be the standard “dbo” qualifier:
dbo.Employee or a custom schema that you have created HumanResources.Employee.
This policy checks to see that your table references all contain a schema
prefix. NOTE: this is in beta as the algorithm to try to catch all instances is
more complex than you’d think. This may over-catch or under-catch for some
scripts.</p>

<h3><a name="_Toc273689338">Comment Header Policy</a></h3>

<p class=MsoNormal>For good record keeping and change auditing, it’s great to
have change comments in your routines. This policy will check to make sure you
have a fairly standard comment header included in your stored procedure and
function definitions. This policy specifically looks to make sure your
definition contains comments for: Name, Description, Author and Change History.
You can easily fulfill this policy by using the <a href="#_Simple_Text_Inserts">Simple
Text Inserts</a> “Insert Comment Header” utility script.</p>

<p class=MsoNormal>In addition, this policy check looks for “recent” comment
additions to ensure that changes are being appropriate. The threshold is
different depending on how the policies are run. If you are saving an
individual script, creating a script through the <a
href="#_Direct_Database_Object">Direct Database Object Scripting</a> or
updating generated object scripts via <a href="#_Updating_Scripted_Objects">updating
object scripts</a> feature, the tool will look for comments created either
yesterday or today. If you are running the policy checks via the <span
style='font-family:"Cambria","serif"'>Tools </span><span style='font-family:
Wingdings'>à</span><span style='font-family:"Cambria","serif"'> Script Policy
Checking</span> menu option, it will look for comments created within the last
40 days. The dates need to be in the mm/dd/yyyy format.</p>

<h3><a name="_Toc273689339">Stored Procedure Parameter Policy</a></h3>

<p class=MsoNormal>This is a configurable policy that will enforce that certain
parameters be included in a defined set of stored procedures. The configuration
is set in the <a href="#EnterpriseTeamSettings">Enterprise / Team Settings</a>
configuration file. You can filter your stored procedures by Schema and Target
database and define the parameter check by parameter name and parameter data
type. If the policy does not find the specified parameter defined in the
signature of a stored procedure that meets the filter criteria, the script will
fail the check.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name="_Toc273689340"></a><a name="_Direct_Database_Object"></a>Direct
Database Object Scripting</h1>

</div>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc273689341"></a><a name="_Scripting_Database_Objects"></a>Scripting
Database Objects</h2>

<p class=MsoNormal>Without leaving&nbsp;<i>Sql Build Manager&nbsp;</i>you can
create SQL object scripts directly from your designated database and add them
into your Sql Build Project. You can do them one at a time, or script an entire
class of database objects all at once! Here's how...</p>

<p class=MsoListParagraph style='margin-left:.75in;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Select
a database to be your script source via the Scripting menu's database drop down
list:</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=351 height=228 id="Picture 230"
src="SqlBuildManagerManual_files/image068.jpg"></p>

<p class=MsoListParagraph style='margin-left:.75in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Once
a database is selected, the next menu item list is available, where you can
select the object type:</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=439 height=196 id="Picture 236"
src="SqlBuildManagerManual_files/image069.jpg"></p>

<p class=MsoListParagraph style='margin-left:.75in;text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Now
that you've selected your object type,&nbsp;<i>Sql Build Manager </i>presents
you with a list of all objects in the source database for you to select. You
can check one or more. You can also right-click on any one of them to get a
script preview of the object.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=465 height=228 id="Picture 239"
src="SqlBuildManagerManual_files/image070.jpg"></p>

<p class=MsoListParagraph style='margin-left:.75in;text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Once
you've selected your objects for scripting, click the &quot;Add Files&quot;
button and the scripts are created. As a means to confirm the selections and
give you a chance to exclude duplicates, you next see a confirmation screen.
Files that match (by file name) items already in your build file are colored in
orange. To add the checked files into your build project, click on &quot;Add
Checked Files&quot;.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=603 height=191 id="Picture 242"
src="SqlBuildManagerManual_files/image071.jpg"></p>

<p class=MsoListParagraphCxSpFirst style='margin-left:.75in;text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Lastly,
you need to tell&nbsp;<i>Sql Build Manager&nbsp;</i>how to handle running the
files against a target database; you do this via the configuration pop-up. The
same configuration will be applied to all of the scripts you're adding in this
&quot;bulk&quot; fashion. Check out&nbsp;<a
href="#_Script_Configuration:_Setting">script configuration</a>&nbsp;for&nbsp;all
of your options</p>

<p class=MsoListParagraphCxSpLast align=center style='margin-left:.75in;
text-align:center'><br>
<img border=0 width=394 height=216 id="Picture 248"
src="SqlBuildManagerManual_files/image072.jpg"></p>

<h2><a name=UpdatingScriptedObjects></a><a name="_Toc273689342"></a><a
name="_Updating_Scripted_Objects"></a>Updating Scripted Objects</h2>

<p class=MsoNormal>Once you have added a&nbsp;<a
href="#_Scripting_Database_Objects">database object script to your build
project</a>, what happens if you update your database again and need to re-sync
your scripts? <i>Sql Build Manager&nbsp;</i>has an answer for that as well.
Because it generates scripts with both a defined extension (.PRC, .UDF, .TAB,
.VIW for stored procedures, functions, tables and views respectively) and a
pre-defined header section - it can also determine how to update those scripts
from the source.</p>

<p class=MsoListParagraph style='margin-left:.75in;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Start
be selecting one (or more) scripts from your project list that have the
extensions listed, and the &quot;Update Object Create Scripts&quot; context
menu item will be enabled. From here, you have two choices: use the settings
from the original script header or use the target database override setting
(see that advanced topic).</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=634 height=163 id="Picture 278"
src="SqlBuildManagerManual_files/image073.jpg"></p>

<p class=MsoListParagraph style='margin-left:.75in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Once
you have selected how to re-generate the scripts, you are presented with a
confirmation window (similar to the one from the original scripting), then just
click &quot;Update Checked Files&quot; update the scripts in the project file.</p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='text-align:center'>&nbsp;<img border=0 width=693
     height=154 id="Picture 281" src="SqlBuildManagerManual_files/image074.jpg"></li>
</ul>

<p class=MsoListParagraphCxSpFirst style='margin-left:.75in;text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>You
can also update the scripts for <i>all </i>scriptable objects in the project
file via the &quot;<span style='font-family:"Cambria","serif"'>Scripting&nbsp;</span><span
style='font-family:Wingdings'>à</span><span style='font-family:"Cambria","serif"'>
Update Object Create Scripts</span>&quot; main menu option.</p>

<p class=MsoListParagraphCxSpLast align=center style='margin-left:.75in;
text-align:center'><img border=0 width=286 height=203 id="Picture 224"
src="SqlBuildManagerManual_files/image075.jpg"></p>

<h2><a name=CreatingBackoutPackage></a><a name="_Toc273689343">Creating a “Back
out Package”</a></h2>

<p class=MsoNormal>There may be an instance where after you have already
committed a package to an environment that you realize something is wrong and
you need to back out your changes. Since you’ve committed and you can’t do a
rollback, you could restore from a backup copy. Alternatively, you can create a
back out package that will revert your changes. Sql Build Manager can automate
much of this back out creation as long as you have an unaltered version of the
database somewhere (i.e. to this BEFORE you apply your changes to your
production database!). To get started, click on the “<span style='font-family:
"Cambria","serif"'>Scripting </span><span style='font-family:Wingdings'>à</span><span
style='font-family:"Cambria","serif"'> Create back out package</span>” main
menu option.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=284 height=204 id="Picture 225"
src="SqlBuildManagerManual_files/image076.jpg"></p>

<p class=MsoNormal>This will open update the Backout Package form. To change
your database source to an unaltered version of your database, use the “<span
style='font-family:"Cambria","serif"'>Action </span><span style='font-family:
Wingdings'>à</span><span style='font-family:"Cambria","serif"'> Change SQL
Server Connection</span>” menu option, selecting both your server and database
name. The selection will appear in the gray panel for reference. The two list
boxes are as follows:</p>

<p class=MsoNormal>“Scripts that will be updated” – these are scripts that the
Sql Build Manager recognizes as having been scripted through the tool. Because
of this, it will know how to re-script them from the new target.</p>

<p class=MsoNormal>“Scripts that will NOT be updated” – scripts in this list
fall in 1 of two categories. </p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>First, is “Not found on Target Server” – this means that the
object in your build package hasn’t been created on the new source. Since this
is a new object, you must decide on your own what to do with it (i.e. leave it
there since it’s new and it doesn’t really matter, or create a drop script </p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Second, is “Manual Scripts” – this means that the script is
something you wrote, not something the tool created for you. Because of this,
you will need to determine what action needs to be taken for a back out.</p>

<p class=MsoNormal>Once you have set the source server and database, reviewed
this lists, and set the back out file name (which will default to “Backout_&lt;original
package name&gt;”, just click the “Create Back out Package” button. If there
are any errors, the back out package will not be created and you can use the “<span
style='font-family:"Cambria","serif"'>Help </span><span style='font-family:
Wingdings'>à</span><span style='font-family:"Cambria","serif"'> View
Application Log File</span>” link to view the errors.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=624 height=604 id="Picture 229"
src="SqlBuildManagerManual_files/image077.jpg"></p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name="_Toc273689344">Reporting and Adhoc Queries</a></h1>

</div>

<h2><a name=ScriptStatusReporting></a><a name="_Toc273689345">Script Status
Reporting</a></h2>

<p class=MsoNormal>This process will check across multiple databases to see
whether or not the scripts configured in your Sql Build File (.sbm or .sbx)
have been run on those databases and if they have been run, whether or not they
are in sync with the build file.</p>

<ol style='margin-top:0in' start=1 type=1>
 <li class=MsoNormal>From the main Sql Build Manager window, select Action <span
     style='font-family:Wingdings'>à</span> Configure Multi Server/Database Run</li>
</ol>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=254 height=314 src="SqlBuildManagerManual_files/image078.jpg"></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Configure
the databases you want to generate the report against.  (See <a
href="#_Configuring_Multiple_Database">Configuring Multiple Database Targets</a>)</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:"Cambria","serif"'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>From the opened Multiple Database Run Configuration Page, select 
the <span style='font-family:"Cambria","serif"'>Reports </span><span
style='font-family:Wingdings'>à</span><span style='font-family:"Cambria","serif"'>
Script Status Report </span>menu item</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=289 height=131 src="SqlBuildManagerManual_files/image079.png"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
Script Status Reporting window will display.</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=438 height=120 src="SqlBuildManagerManual_files/image080.jpg"></p>

<p class=MsoListParagraphCxSpMiddle>From this window, you can select the output
type you would like for the report.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in'>Summary: A pared
down report that shows only scripts that are not synchronized between the build
file and the target database and presents in an   HTML document.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in'>HTML: A full HTML
report showing the status of all the scripts in the build file. Those that are
out of sync are presented in red.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in'>CSV: A full
report showing the status of all scripts in the build file.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in'>XML: A full
report of the raw data for all the scripts in the build file.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>To
get the report, click the <span style='font-family:"Cambria","serif"'>Generate
Report </span>button. You will be prompted to provide a file name to save the
report output, and then the program will thread out the processing, collate the
results and present the report in the default viewer for the specified file
type.</p>

<h3>&nbsp;</h3>

<h2><a name=ObjectComparisonReport></a><a name="_Toc273689346">Object
Comparison Report</a></h2>

<p class=MsoNormal>This report option will scan your configured database and
generate hash values for all of the database objects in them. It will then
create a report showing which objects are not in sync with the baseline
database chosen. NOTE: running this report may be very time consuming depending
on the number of objects in the databases and the number of databases
configured for comparison.</p>

<ol style='margin-top:0in' start=1 type=1>
 <li class=MsoNormal>From the main Sql Build Manager window, select Action <span
     style='font-family:Wingdings'>à</span> Configure Multi Server/Database Run</li>
</ol>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=254 height=314 src="SqlBuildManagerManual_files/image081.jpg"></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Configure
the databases you want to generate the report against.  (See <a
href="#_Configuring_Multiple_Database">Configuring Multiple Database Targets</a>).
The database that is configured with the lowest sequence number will be used as
the baseline database.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>From
the opened Multiple Database Run Configuration Page, select  the <span
style='font-family:"Cambria","serif"'>Reports </span><span style='font-family:
Wingdings'>à</span><span style='font-family:"Cambria","serif"'> Object
Comparison Report</span> menu item</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=246 height=109 src="SqlBuildManagerManual_files/image082.jpg"></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
Object Comparison Report form will display.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=455 height=287 src="SqlBuildManagerManual_files/image083.jpg"></p>

<p class=MsoListParagraphCxSpFirst>From this window, you can select the output
type you would like for the report.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in'>Summary: A pared
down report that shows only the objects that are not synchronized between databases.
This report will present the server, database, object type, object name and
status of that object with relation to the base database.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in'>XML: A full
report of the raw data for the objects in the database</p>

<p class=MsoListParagraphCxSpMiddle>You also have the option to run the report
in parallel/threaded fashion or single threaded. While the parallel option will
generally be faster, it does have the potential to impact the responsiveness of
your computer.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>To
get the report, click the <span style='font-family:"Cambria","serif"'>Generate
Report </span>button. You will be prompted to provide a file name to save the
report output, and then the program will begin processing. The status of the
processing on each database is displayed in the table. Once complete it will
collate the results and present the report in the default viewer for the
specified file type.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>After
the processing is completed, the “Additional Analysis” button is enabled.
Clicking this button will present a Comparison Analysis window where you have
the ability to change the baseline database to be any database that was used in
the comparison. Selecting a database and clicking <span style='font-family:
"Cambria","serif"'>Generate Report </span>will create a new summary report and
open it in your default HTML viewer. Note that this option does not re-scan the
databases but rather reuses the data gleaned in the original run so there is no
processing delay or performance impact.</p>

<p class=MsoListParagraphCxSpLast align=center style='text-align:center'><img
border=0 width=331 height=210 id="Picture 31"
src="SqlBuildManagerManual_files/image084.png"></p>

<p class=MsoNormal style='margin-left:.5in'>&nbsp;</p>

<p class=MsoNormal style='margin-left:.5in'>&nbsp;</p>

<h2><a name=RunningAdhocQueriesagainstmultiple></a><a name="_Toc273689347"></a><a
name="_Toc226946967">Running Adhoc Queries against multiple targets</a></h2>

<p class=MsoNormal>This option allows you to run any query you specify against
multiple databases at once. These databases can be spread across multiple
servers as well. A report with the collated results is presented in the format
you select.</p>

<p class=MsoListParagraph style='text-indent:-.25in'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>From the main Sql Build Manager window, select <span style='font-family:
"Cambria","serif"'>Action </span><span style='font-family:Wingdings'>à</span><span
style='font-family:"Cambria","serif"'> Configure Multi Server/Database</span>
Run</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=254 height=314 id="Picture 1"
src="SqlBuildManagerManual_files/image081.jpg"></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Configure
the databases you want to run the Adhoc query against.  (See <a
href="#_Configuring_Multiple_Database">Configuring Multiple Database Targets</a>)
</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:"Cambria","serif"'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>From the opened Multiple Database Run Configuration Page, select 
the <span style='font-family:"Cambria","serif"'>Reports </span><span
style='font-family:Wingdings'>à</span><span style='font-family:"Cambria","serif"'>
Adhoc Query Execution </span>menu item</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=322 height=136 id="Picture 7"
src="SqlBuildManagerManual_files/image085.png"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
query window will display. In this window, you have the option to select the
output type for the report: </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in'>CSV - comma
separated values</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in'>HTML - a
formatted HTML report</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in'>XML - the raw
data retrieved in XML format.</p>

<p class=MsoListParagraphCxSpMiddle>Also through the <span style='font-family:
"Cambria","serif"'>Action</span> menu item, you can <span style='font-family:
"Cambria","serif"'>Open</span> or <span style='font-family:"Cambria","serif"'>Save</span>
a SQL query for reuse.</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=389 height=281 src="SqlBuildManagerManual_files/image086.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Once
you have selected your output type and either typed in your query or opened an
existing query from a file, click the <span style='font-family:"Cambria","serif"'>Run
Script</span> button. You will be prompted for a location and file name to save
the results then the program will then thread out the execution of the script
to all of the database targets you specified in step #2, collect the data,
collate it and open the output file in the default viewer for the specified
file type. The columns included in the report are the server name, database
name, row count and then the columns specified in the query you provided.</p>

<p class=MsoListParagraphCxSpLast>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name=StoredProcedureTesting></a><a name="_Toc273689348">Stored Procedure
Testing</a></h1>

</div>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc273689349"></a><a name="_Stored_Procedure_Testing-Setup"></a>Stored
Procedure Testing-Setup</h2>

<h4><a name="Creatingyourfirsttestconfiguration&lt;br&gt;">Creating your first
test configuration&nbsp;</a></h4>

<p class=MsoListParagraph style='text-indent:-.25in'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>You access the stored procedure testing module via the main screen&nbsp;<i>Tools
| Stored Procedure Testing&nbsp;</i>menu option</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=409 height=96 id="Picture 329"
src="SqlBuildManagerManual_files/image087.jpg"></p>

<p class=MsoListParagraph style='text-indent:-.25in'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>This will open up a new Stored Procedure Test Configuration window. To
get going, you will need to create a new test configuration. Use the&nbsp;<span
style='font-family:"Cambria","serif"'>File </span><span style='font-family:
Wingdings'>à</span><span style='font-family:"Cambria","serif"'> Open/New Test
Configuration</span>&nbsp;menu option to open up a file dialog window. Type in
your file name and click &quot;Open&quot;. You will now see a &quot;Select
Database&quot; window populated with the list of databases available on your
current server. A configuration can only address a single database, so if you
need to test different stored procedures on another database, you will need to
create another configuration. Note however, if you have two or more databases
with the same stored procedures, you can use a single configuration across
those databases.</p>

<p class=MsoNormal align=center style='text-align:center'><a
href="http://sqlsync.googlepages.com/sptest-selectDb.png/sptest-selectDb-full;init:.png"><span
style='color:windowtext;text-decoration:none'><img border=0 width=200
height=81 id="Picture 318" src="SqlBuildManagerManual_files/image088.jpg"
alt="Description: http://sqlsync.googlepages.com/sptest-selectDb.png/sptest-selectDb-medium;init:.jpg"></span></a></p>

<p class=MsoListParagraph style='text-indent:-.25in'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Now that you have your database set, you can start selecting stored
procedures and creating test cases.</p>

<h4><a name=AddingStoredProcedures>Adding Stored Procedures</a></h4>

<p class=MsoListParagraph style='text-indent:-.25in'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>To add your first test case, right-click n the white area on the left
(this is where your selected stored procedures and test cases will soon
display) and select the only active option - <span style='font-family:"Cambria","serif"'>Add
New Stored Procedure</span>; this will give you the Stored Procedure list:</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=260 height=260 id="Picture 332"
src="SqlBuildManagerManual_files/image089.jpg"><span style='font-family:Wingdings'>à</span>
<img border=0 width=456 height=224 id="Picture 338"
src="SqlBuildManagerManual_files/image090.jpg"></p>

<p class=MsoListParagraph style='text-indent:-.25in'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>From this list (which shows all of the user stored procedures on the
target database that have not been previously selected), check the stored
procedures that you want to create test cases for (this will eventually be all
of them right?) and click &quot;<span style='font-family:"Cambria","serif"'>Add
Checked Files</span>&quot;.</p>

<h4><a name=Creatingatestcase>Creating a test case</a></h4>

<p class=MsoListParagraph style='text-indent:-.25in'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>To create a test case, select a stored procedure from the left side list
and right-click to pull up the menu. From this menu, select &quot;Add <span
style='font-family:"Cambria","serif"'>New Test Case to &lt;sp name&gt;</span>&quot;.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=426 height=237 id="Picture 341"
src="SqlBuildManagerManual_files/image091.jpg"></p>

<p class=MsoListParagraph style='text-indent:-.25in'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>This will then activate the right side, test configuration section of
the screen where you can set-up the test</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=514 height=406 id="Picture 347"
src="SqlBuildManagerManual_files/image092.jpg"></p>

<h4><a name="TestCaseDefinition&lt;br&gt;">Test Case Definition<br>
<br>
</a></h4>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i>Name&nbsp;</i>-
required. Sets the descriptive name of the test. This is what will appear in
the tree view on the left of the screen</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i>Execution
Type</i>&nbsp;- required. A drop down selection of&nbsp;<br>
<span style='font-family:"Courier New"'>ReturnData</span>:&nbsp;expects that a
result set with 1 or more columns and possibly 0-n rows returned<br>
<span style='font-family:"Courier New"'>NonQuery</span>:&nbsp;a stored
procedure that does not return data (an insert, update or delete for example)<br>
<span style='font-family:"Courier New"'>Scalar</span>:&nbsp;expects that the
result set consists of a single data point (i.e. 1 row with 1 column)</p>

<h4><a name="Parameters&lt;br&gt;">Parameters&nbsp;<br>
<br>
</a></h4>

<p class=MsoListParagraphCxSpFirst style='margin-left:.75in;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i>Parameters&nbsp;</i>-
optional based on the stored procedure. These are the parameters derived from
the stored procedure as it exists in the database. The type of each can be
displayed by hovering over the name of the parameter.</p>

<p class=MsoListParagraphCxSpLast style='margin-left:.75in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i>Parameters
with &quot;Sql Query&quot;&nbsp;</i>set - optional. This will create an array
of unit tests, one for each result set of the query. For example, if the
employee table has 10 employees, and you paste in a SQL statement &quot;SELECT
EmployeeID FROM Employees&quot;, then save and execute the test, you will run
10 tests.<br>
NOTE: The query should only return one column of data. Also if there are
multiple parameters, this can be used in combination to create an exponential
number of tests.</p>

<h4><a name=ExpectedResults>Expected Results</a></h4>

<p class=MsoListParagraphCxSpFirst style='margin-left:.75in;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i>Result</i>&nbsp;-
required. One of 4 result types must be set for the execution of the stored
procedure:<br>
<span style='font-family:"Courier New"'>Success</span>:&nbsp;The stored
procedure executed properly. No exceptions were thrown by SQL Server<br>
<span style='font-family:"Courier New"'>GenericSqlException</span>:&nbsp;If you
expect that with your parameter values set, you will get an execution exception<br>
<span style='font-family:"Courier New"'>PKViolation</span>:&nbsp;If you are
forcing a Primary Key violation with your parameter values<br>
<span style='font-family:"Courier New"'>FKViolation</span>:&nbsp;If you are
forcing a Foreign Key violation with your parameter values&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i>Row
Count&nbsp;</i>-optional. If you want to check that the proper number of rows
is returned with the stored procedure, you can set this value.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i>Row
Count Operator&nbsp;</i>- optional. Used in conjunction with the Row Count
number. It allows you to specify that the row count be <span style='font-family:
"Courier New"'>EqualTo</span>,&nbsp;<span style='font-family:"Courier New"'>GreaterThan</span>&nbsp;or&nbsp;<span
style='font-family:"Courier New"'>LessThan</span>&nbsp;the number specified in
the Row Count.</p>

<p class=MsoListParagraphCxSpLast style='margin-left:.75in;text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i>Column
Count</i>&nbsp;- optional. If you want to check that the proper number of rows
is returned, you can set this value.</p>

<h4><a name=ExpectedDataOutput>Expected Data Output</a></h4>

<p class=MsoNormal>You can add as many of these data checks as you'd like by
clicking the &quot;Add Expected Output&quot; link button. For each one, there
are 3 settings:</p>

<p class=MsoListParagraphCxSpFirst style='margin-left:.75in;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i>Column
Name</i>&nbsp;- required. The name of the column that you would like to perform
a data value check against.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i>Value&nbsp;</i>-
required. The value that you expect in the designated column. NOTE: the value
check is not case sensitive and does perform a trim, so extra spaces are also
ignored.</p>

<p class=MsoListParagraphCxSpLast style='margin-left:.75in;text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i>Row
#</i>&nbsp;- optional. The row number of the returned data that should be
checked for the value. If not specified, the first row is checked. Also, for
you developers out there, this is a &quot;1&quot; based value so the first row
returned would be Row #1 not Row #0.</p>

<h4><a name=AdditionalFeatures>Additional Features</a></h4>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal><b>Get SQL Script</b>- generates for you the SQL that will
     be executed bases on the current parameter value setting to allow you to
     cut and paste as needed.</li>
 <li class=MsoNormal><b>Insert Type Default Values</b>&nbsp;- puts in a
     non-null value for each parameter. For numeric, it adds the default value
     of 0. For strings and characters is adds in an empty string. For
     date/time, it adds the current date and time.</li>
 <li class=MsoNormal><b>Paste Execution Script</b>&nbsp;- if you use SQL server
     profile, you can paste in the execution script you glean from there. The
     tool will parse out the parameters and values and insert them into the
     proper place.</li>
</ul>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc273689350">Stored Procedure Testing - Execution (Manual and
Automated)</a></h2>

<p class=MsoNormal>Once you have&nbsp;<a
href="http://sqlsync.googlepages.com/storedproceduretesting">set up your stored
procedure tests</a>, you'll of course want to run them, this will explain how
to do that and also interpret the results you see.</p>

<h3><a name="Runningyourstoredproceduretests(manual)&lt;"></a><a
name="_Toc273689351">Running your stored procedure tests (manual)</a><br>
<br>
</h3>

<p class=MsoListParagraph style='text-indent:-.25in'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Execution of your tests is very straightforward. Simply check the tests
you want to run (or use the &quot;Check All&quot; link) and click the &quot;Run
Checked Test&quot; button. An execution/results window will open up and the
tests will automatically start.</p>

<p class=MsoNormal align=center style='text-align:center'><a
href="http://sqlsync.googlepages.com/sptest-run.png/sptest-run-full;init:.png"><span
style='color:windowtext;text-decoration:none'><img border=0 width=318
height=207 id="Picture 370" src="SqlBuildManagerManual_files/image093.jpg"
alt="Description: http://sqlsync.googlepages.com/sptest-run.png/sptest-run-full.png"></span></a></p>

<h3><a name="_Toc273689352"></a><a name=Interpretingtheresults>Interpreting the
results</a></h3>

<p class=MsoListParagraph style='text-indent:-.25in'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The tool will run through all of the tests you had checked, logging the
results for each test and displaying the summary results in the execution
window</p>

<p class=MsoNormal align=center style='text-align:center'><a
href="http://sqlsync.googlepages.com/sptest-results.png/sptest-results-full;init:.png"><span
style='color:windowtext;text-decoration:none'><img border=0 width=600
height=233 id="Picture 371" src="SqlBuildManagerManual_files/image094.jpg"
alt="Description: http://sqlsync.googlepages.com/sptest-results.png/sptest-results-custom;size:600,272.png"></span></a></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>For
each test run, you will get a result row, with an success/failure indicator,
the stored procedure name, the test case name and the results summary.(Note: if
there is a failure, the row will be highlighted in red). There is also a
summary across the bottom, listing the number of stored procedures that were
tested, the number of test cases executed, the number passed and the number
failed.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>To
view the result details of the test, you can right-click on the results row and
select &quot;<span style='font-family:"Cambria","serif"'>Show Detailed Results</span>&quot;.
The detail window will pop-up. In the top section you will get the same information
as the summary, however the results is now fully displayed showing all of the
criteria that were used in the test and the actual results retrieved. In the
bottom section, the actual SQL that was executed is shown in case you need to
retrieve it for another use.</p>

<p class=MsoListParagraphCxSpLast align=center style='text-align:center'><a
href="http://sqlsync.googlepages.com/sptest-result-detail.png/sptest-result-detail-full;init:.png"><span
style='color:windowtext;text-decoration:none'><img border=0 width=539
height=282 id="Picture 372" src="SqlBuildManagerManual_files/image095.jpg"
alt="Description: http://sqlsync.googlepages.com/sptest-result-detail.png/sptest-result-detail-full.png"></span></a></p>

<h3><a name="_Toc273689353"></a><a name=Savingtheresults>Saving the results</a></h3>

<p class=MsoNormal>If you need to save your results for later review or for
proof of testing, you can do that too. From the results summary page, you can
right-click and display the menu. Select the &quot;<span style='font-family:
"Cambria","serif"'>Save All Test Results</span>&quot;. The resulting file will
be an XML document that contains all of the detailed information regarding the
test execution that you can get via the forms above, plus the name of the
target server, target database, and start and end times. Also, the test case
definition is included with each result.</p>

<p class=MsoNormal align=center style='text-align:center'><a
href="http://sqlsync.googlepages.com/sptest-save.png/sptest-save-full;init:.png"><span
style='color:windowtext;text-decoration:none'><img border=0 width=200
height=111 id="Picture 373" src="SqlBuildManagerManual_files/image096.jpg"
alt="Description: http://sqlsync.googlepages.com/sptest-save.png/sptest-save-medium;init:.jpg"></span></a></p>

<h2><a name="_Toc273689354"></a><a name=Automatingstoredproceduretesting>Automating
stored procedure testing</a></h2>

<p class=MsoNormal>You can easily automate your stored procedure testing by
taking advantage of the console helper executable and&nbsp;<a
href="#_Command_Line_Execution">command-line execution</a>. Running a stored
procedure test, you will need 4 command line parameters:</p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/test=&quot;.sptest config file&quot;</span>&nbsp;-
     informs the tool that you will be performing a stored procedure test
     execution using the supplied test configuration file.</li>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/server=serverName</span>&nbsp;- sets the
     target server to connect to</li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/database=target server</span>&nbsp;- sets
     the target database to run the stored procedures on</li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal><span style='font-size:10.0pt;line-height:115%;font-family:
     "Courier New";color:#632423'>/log=logfilename.xml</span>&nbsp;- sets the
     name of the XML results file you want the results sent to.</li>
</ul>

<p class=MsoNormal>Example: SqlBuildManager.Console.exe
/test=&quot;test3.sptest&quot; /server=myserver /database=myDb
/log=&quot;C:\logfile.xml&quot;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name="_Toc273689355">Additional Program Information</a></h1>

</div>

<h2><a name="_Toc273689356">Associated File Types</a></h2>

<p class=MsoNormal>The application has multiple file types associated with it
at install time. These files serve many purposes for different features of the
application.</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>.sbm</b> : <img border=0 width=33 height=32
src="SqlBuildManagerManual_files/image097.png"
alt="Description: C:\Projects\SqlSync\Images\SqlBuildManager.png">Single file
package that contain the scripts, script metadata and run result history for
the package. </p>

<p class=MsoListParagraphCxSpMiddle>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>.sbx</b> :<img border=0 width=32 height=32
src="SqlBuildManagerManual_files/image098.png"> XML configuration file. This
contains the script metadata for run time settings. The scripts are assumed to
be in the same folder as the .sbx file. This file can be packaged into a single
.sbm file via the <span style='font-family:"Cambria","serif"'>Action </span><span
style='font-family:Wingdings'>à</span><span style='font-family:"Cambria","serif"'>
Package Scripts into Project File (.sbm)</span> menu option.</p>

<p class=MsoListParagraphCxSpMiddle>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>.sbe</b> : <img border=0 width=33 height=32 id="Picture 3"
src="SqlBuildManagerManual_files/image097.png"
alt="Description: C:\Projects\SqlSync\Images\SqlBuildManager.png">A “Sql Build
Export” file. The product of an export of scripts from a .sbm file. This is
essentially the same as a .sbm file, but is used to denote scripts that are
intended to be imported into another sbm file.</p>

<span style='font-size:11.0pt;line-height:115%;font-family:"Calibri","sans-serif"'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>.multiDb : <img border=0 width=32 height=32
src="SqlBuildManagerManual_files/image099.png"></b>Multi-database execution
configuration file. See <a href="#_Configuring_Multiple_Database">Configuring
Multiple Database Targets</a>.</p>

<p class=MsoListParagraphCxSpMiddle><b>&nbsp;</b></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>.multiDbQ : <img border=0 width=32 height=32 id="Picture 10"
src="SqlBuildManagerManual_files/image100.png"></b>Multi-database configuration
query file. See <a href="#_Create_Configuration_via">Create Configuration via
Query</a></p>

<p class=MsoListParagraphCxSpMiddle>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>.audit</b> : <img border=0 width=32 height=32
src="SqlBuildManagerManual_files/image101.png">a auditing script creation
template file. These files are used to create a group of tables that require
data auditing.  The program can then generate audit tables and triggers for
these tables.</p>

<p class=MsoListParagraphCxSpMiddle>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>.sqlauto</b> : <img border=0 width=32 height=32
src="SqlBuildManagerManual_files/image102.png">a configuration file for
automated schema scripting. This can be used for creating a scheduled task to
generate DDL scripts for databases on a regular basis</p>

<p class=MsoListParagraphCxSpMiddle>&nbsp;</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>.sts</b> : <img border=0 width=32 height=32 id="Picture 15"
src="SqlBuildManagerManual_files/image103.png">Sql Table Scripting. A
configuration file of “look-up” or “code tables”. From this, the program can
create script files that can be used to replicate their contents to other
environments. These scripts are re-runable and handle both inserts and updates
of values.</p>

<p class=MsoListParagraphCxSpMiddle>&nbsp;</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>.sptest</b> : <img border=0 width=32 height=32
src="SqlBuildManagerManual_files/image104.png">Stored Procedure test
configuration file. With not programming, the application can create unit tests
for stored procedures. You can supply standard or query based input values and
interrogate execution times and return values to determine pass/fail criteria.</p>

<p class=MsoNormal>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name=DatabaseAnalysis></a><a name="_Toc273689357">Database Analysis</a></h1>

</div>

<p class=MsoNormal>Sql Build Manager has the built in features to run size and
utilization analysis against a SQL server. </p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=376 height=181 src="SqlBuildManagerManual_files/image105.jpg"></p>

<h2><a name="_Toc273689358">Server Analysis</a></h2>

<p class=MsoListParagraph style='text-indent:-.25in'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Upon selecting the <span style='font-family:"Cambria","serif"'>Tools </span><span
style='font-family:Wingdings'>à</span><span style='font-family:"Cambria","serif"'>
Database Analysis</span> menu option, the Database Size Summary window will
open. On loading, it will begin scanning the current server (as identified in
both the title bar and the “Recent Servers” drop down box to gather the data.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=854 height=232 src="SqlBuildManagerManual_files/image106.jpg"></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Once
the scan is complete, you the grid will be populated with four pieces of data
for each database associated with the server:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Database Name – fairly obvious! </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Date Created/Last Restore – this is the date that the associated
master database has for the creation date of the database. This date is updated
whenever a database is restored from a back-up as well</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Size (MB) – again, fairly obvious. This is the size that SQL
Server has allocated for the database MDF file.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Location – The physical drive path where the MDF file is located.
Note that the path is relative to the SQL Server, not your local machine.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>You
can run analysis on another server by changing the database selection in the
“Recent Servers” drop down</p>

<p class=MsoListParagraphCxSpLast>&nbsp;</p>

<h2><a name="_Toc273689359">Individual Database Details</a></h2>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>From
the Database Size Summary form, you can gather individual database details by
right-clicking on the database and selecting the <span style='font-family:"Cambria","serif"'>Get
Database Details </span>menu item.</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=320 height=120 id="Picture 9"
src="SqlBuildManagerManual_files/image107.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
size analysis for the selected database will run and load the data form. This
contains data about each table in the database. (These columns are all
sortable)</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Table Name – obvious. </p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Row Count – the number of rows that SQL Server currently reports
from its statistics (not always the same as a “SELECT count(*)…” query, but
generally very close</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Data – the size of the data stored in the table (in KB)</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Indexes  - the size of all of the indexes associated with the table
(in KB)</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Unused – the amount of space that is allocated to the table but
it currently empty (in KB)</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Total – the total amount of space that SQL Server has allocated
for this table and all of its indexes</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Average Data – the average amount of space used per row in the
table</p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Average Index – the average amount of space used per row for all
of the indexes on the table</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=735 height=279 id="Picture 12"
src="SqlBuildManagerManual_files/image108.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name=DataExtractionandInsertion></a><a name="_Toc273689360">Data
Extraction and Insertion</a></h1>

</div>

<p class=MsoNormal>Sql Build Manager has the ability to extract non-binary data
out of a table and store it in a formatted file. Conversely, it can take this
formatted data and create pairs if INSERT/UPDATE statements for reinsertion and
or updating of this data. It can also be used to synchronize data between
environments. <br>
NOTE: There is a current limitation with this extract. It will not properly
handle data that contains in-line carriage returns. This will cause a
formatting error of the insert/update scripts.</p>

<h2><a name="_Toc273689361">Data Extraction</a></h2>

<p class=MsoListParagraph style='text-indent:-.25in'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Open the Data Extraction form via the <span style='font-family:"Cambria","serif"'>Tools
</span><span style='font-family:Wingdings'>à</span><span style='font-family:
"Cambria","serif"'> Data Extraction</span> menu item from the main window</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=404 height=158 id="Picture 19"
src="SqlBuildManagerManual_files/image109.jpg"></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>On
the Data Extract window, you will need to do the following:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Select
your output directory via the <span style='font-family:"Cambria","serif"'>Action
</span><span style='font-family:Wingdings'>à</span><span style='font-family:
"Cambria","serif"'> Change Destination</span> Folder menu .</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Select
your source database with the “Select Database” dropdown list. (You can change
your server via the <span style='font-family:"Cambria","serif"'>Action </span><span
style='font-family:Wingdings'>à</span><span style='font-family:"Cambria","serif"'>Change
SQL Server Connection</span> menu item or the <span style='font-family:"Cambria","serif"'>Recent
Servers</span> list)</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Once
you select the database, the <span style='font-family:"Cambria","serif"'>Tables
to Script</span> list will populate with the table list for that database as
well as the row count for each table.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>d.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Next,
check the tables you want to extract from and click the “<span
style='font-family:"Cambria","serif"'>Extract Data</span>” link.</p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;text-indent:-.25in'>e.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
files that were created display in the “<span style='font-family:"Cambria","serif"'>Extract
Results</span>” list. If you want to open a file, you can right-click on it and
select “<span style='font-family:"Cambria","serif"'>Open File</span>”.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=550 height=325 id="Picture 22"
src="SqlBuildManagerManual_files/image110.jpg"></p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc273689362"></a><a name=DataInsertionScriptCreation>Data
Insertion Script Creation</a></h2>

<p class=MsoNormal>Once you have <a href="#DataExtractionandInsertion">extracted
data</a>, what are you to do with it? Well, you can always generate scripts to
put it back! This is useful create a restore for a table and also to move data
easily from one environment to another. In order to get it back into a table, you’ll
need to create the INSERT/UPDATE script combinations for the extracted data.</p>

<p class=MsoListParagraph style='text-indent:-.25in'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Open <span style='font-family:"Cambria","serif"'>the Data Extract Script
Creation</span> Form via the <span style='font-family:"Cambria","serif"'>Tools </span><span
style='font-family:Wingdings'>à</span><span style='font-family:"Cambria","serif"'>
Create Scripts from Extracted Data</span> menu option.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=383 height=166 id="Picture 25"
src="SqlBuildManagerManual_files/image111.jpg"></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Open
a data extract file (*.data) via the Action <span style='font-family:Wingdings'>à</span>
Open Data Extract File menu item. Once you select the file, its contents will
be loaded into the top text box and the script creation process will be kicked
off. The generated scripts are displayed in the bottom text box. These scripts
are suitable to be copied and pasted into a Sql Build Manager project file or
SQL management studio window for execution.</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=663 height=295 id="Picture 28"
src="SqlBuildManagerManual_files/image112.jpg"></p>

<p class=MsoListParagraphCxSpLast align=center style='text-align:center'>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name=DatabaseObjectValidation></a><a name="_Toc273689363">Database
Object Validation</a></h1>

</div>

<p class=MsoNormal>Do you know if your database views, stored procedures and
functions are all in sync? Are all of your table references correct? This functionality
attempts to scan your database and alert you of potential errors – before you
find them at runtime. The validation consists of the following checks:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i>Execution of </i><i><span style='font-family:"Cambria","serif"'>sp_helptext</span>
system procedure for the objects</i>: This checks to ensure that there is no
discrepancy in the object registration in the database</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i>SQL parsing</i>: Runs a SQL server query parse for the object
definition. This uses SQL server’s built-in functionality to run through the
definition and check for the validity of referenced  tables, columns, views,
etc</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i>Execution of </i><i><span style='font-family:"Cambria","serif"'>sp_depends</span>
system stored procedure for the objects</i>: Another means for SQL Server to
check the validity of table references. NOTE: If there is a cross-database
join. SQL server will not necessarily detect the dependency, in which case the
validation will return a status alerting you of such.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Open
the Database Object Validation form using the <span style='font-family:"Cambria","serif"'>Tools
</span><span style='font-family:Wingdings'>à</span><span style='font-family:
"Cambria","serif"'> Database Object Validation</span> menu item.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=377 height=94 id="Picture 32"
src="SqlBuildManagerManual_files/image113.jpg"></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>On
the form, select the database you want to check in the database dropdown list.
(You can also change your SQL Server connection via the <span style='font-family:
"Cambria","serif"'>Action </span><span style='font-family:Wingdings'>à</span><span
style='font-family:"Cambria","serif"'> Change Sql Server Connection</span> menu
option or <span style='font-family:"Cambria","serif"'>Recent Servers </span>list).</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=687 height=268 id="Picture 38"
src="SqlBuildManagerManual_files/image114.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>The
list will populate with the checked Stored Procedures (type ‘P’), Function
(type ‘FN’) and Views (type ‘V’). There are 4 status types that you can get in
the result:</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Valid
– self explanatory. The object passes the validation tests</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Invalid
– again, self explanatory. The object fails one of the validations. You will
get a detail of the failure in the Results column.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'>c.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Caution
– a warning. This doesn’t necessarily mean that the object is invalid, but will
let you know what to look for in the Results column.</p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;text-indent:-.25in'>d.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Cross
Database Join – another warning. The tool detected a possible join across
databases and lets you now that is could not fully validate the references. </p>

<p class=MsoNormal style='margin-left:.75in'>If there are any items that do not
return a Valid status, the warning message will display.</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name=RebuildingPreviouslyCommittedBuild></a><a name="_Toc273689364">Rebuilding
Previously Committed Build Packages</a></h1>

</div>

<p class=MsoNormal>One of the useful features of the logging that Sql Build
Manager performs is that it allows the tool to also reverse engineer a build
package that has been committed to a database (or combination of databases).
This allows you to re-create a package with all of the scripts of the original to
archive off, or run against another environment.</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Open
the <span style='font-family:"Cambria","serif"'>Rebuild Sql Build Manager File</span>
form with the <span style='font-family:"Cambria","serif"'>Tools </span><span
style='font-family:Wingdings'>à</span><span style='font-family:"Cambria","serif"'>
Rebuild Previously Committed Build File</span> menu item</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=380 height=212 src="SqlBuildManagerManual_files/image115.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>When
the form opens, it will automatically scan the server you are connected to. It
will populate the table with all of the build files that it found, originally
sorted in reverse chronological order. Also in the list are the database(s)
that the build file was run against, and the number of scripts that were
included in the file. You can change the server via the <span style='font-family:
"Cambria","serif"'>Action </span><span style='font-family:Wingdings'>à</span><span
style='font-family:"Cambria","serif"'> Changes Sql Server Connection</span> or <span
style='font-family:"Cambria","serif"'>Recent Servers</span> drop down</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=666 height=222 id="Picture 5"
src="SqlBuildManagerManual_files/image116.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Once
you pick a build file to reconstruct, select it in the list, then right-click
and select <span style='font-family:"Cambria","serif"'>Rebuild File</span>
context menu item. You will then be prompted where to save the file.</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=334 height=166 id="Picture 8"
src="SqlBuildManagerManual_files/image117.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>After
the rebuild is completed, you will be prompted whether or not you want to open
this new file. Selecting “Yes” will… you guessed it… open the file</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=234 height=98 id="Picture 11"
src="SqlBuildManagerManual_files/image118.jpg"></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Once
the file opens, you will notice that all of the scripts are marked as “Run
Once”. This may or may not have been the original setting. The logging does not
record your runtime settings, so it defaults to the “safest” setting. You can
however, update these settings as needed for you to reuse the package.</p>

<p class=MsoListParagraphCxSpMiddle align=center style='text-align:center'><img
border=0 width=354 height=178 id="Picture 14"
src="SqlBuildManagerManual_files/image119.jpg"></p>

<p class=MsoListParagraphCxSpLast align=center style='text-align:center'>&nbsp;</p>

<div style='border:none;border-top:solid windowtext 1.0pt;padding:1.0pt 0in 0in 0in'>

<h1><a name=EnterpriseTeamSettings></a><a name="_Toc273689365">Enterprise /
Team Settings</a></h1>

</div>

<p class=MsoNormal>This feature in Sql Build Manager allows you to manage
certain settings for a team, rather than having an isolated/ per installation
settings. This is managed by a settings configuration file that needs to be
accessible by all of your users. </p>

<h3><a name="_Toc273689366">Enterprise/Team Settings Configuration File</a></h3>

<p class=MsoNormal>The team settings are controlled via a common configuration
file that each installation can read from. This can be handled via either
placing this file in a common file share or making it available via an http
URL. If for some reason the file is not readable, the tool will use settings it
was last able to retrieve. The configuration file in an XML formatted file
conforming to a specific XSD schema (this schema is called <span
style='font-family:"Cambria","serif"'>EnterpriseConfiguration.xsd</span> and
can be found in your installation folder).</p>

<h3><a name="_Toc273689367">appSettings Key/Value Pair</a></h3>

<p class=MsoNormal>To point your Sql Build Manager installation to the team
configuration file, you will need to edit the application configuration file <span
style='font-family:"Cambria","serif"'>Sql Build Manager.exe.config</span>. In
this file add or edit the <span style='font-family:"Cambria","serif"'>appSettings</span>
section’s key “<span style='font-family:"Cambria","serif"'>Enterprise.ConfigFileLoation</span>”
and set the value to either a file share location, UNC path, or HTTP URL where
you team settings file can be found. Upon restarting the application, it will
now use this file for team settings.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=896 height=53 id="Picture 16"
src="SqlBuildManagerManual_files/image120.png"></p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name=ScriptChangeSettings></a><a name="_Toc273689368">Script Change
Settings</a></h2>

<h3><a name="_Toc273689369">Table Change Watch</a></h3>

<p class=MsoNormal>This team setting lets you put “alerts” on table changes. It
detects ALTER TABLE and DROP TABLE change scripts upon saving from the Edit
Script Text window. It then compares these table change scripts against a list
of tables that are being “watched”. If there is a match, the alert window is
displayed. This window gives the following information:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Notice that this is a Table Change Watch, what it is and how to
send the notification</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>A description of the alert – should explain what the alert is for</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>A list of tables modified – list the tables altered in your
script that matched an item in the watch list</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>A list of folks that wanted the alert.</p>

<p class=MsoNormal>To give these folks their notice, you’ll need to click the
“Send Notification” button (for each alert box if there is more than one). This
will open your default e-mail program with a configured, populated e-mail –
just click “Send”.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=442 height=248 id="Picture 2"
src="SqlBuildManagerManual_files/image121.jpg"></p>

<h3><a name="_Toc273689370">Configuring Table Change Watch</a></h3>

<p class=MsoNormal>The file can contain one or more &lt;TableWatch&gt; elements
and each of these can contain one or more Table and Notify elements. You can
use any XML editor to help you create the file, but one that can validate
against the schema will be the most helpful.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=732 height=131 id="Picture 13"
src="SqlBuildManagerManual_files/image122.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<h2><a name=ScriptPolicySettings></a><a name="_Toc273689371">Script Policy
Settings</a></h2>

<p class=MsoNormal><a href="#ScriptPolicyChecking">Script policies</a> are
enforced via configuration so you can turn them on and off as needed. This is
handled via &lt;ScriptPolicy&gt; elements in the EnterpriseConfiguration.xml
file. Each script policy will have its own element and PolicyId value. You can
turn off policy enforcement by either removing the element or setting the Enforce
attribute value to false.<br>
The current list of PolicyId’s is:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CommentHeaderPolicy</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>ConstraintNamePolicy</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>GrantExecutePolicy</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>GrantExecuteToPublicPolicy</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>QualifiedNamesPolicy</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>ReRunablePolicy</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>SelectStarPolicy</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>StoredProcParameterPolicy</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>WithNoLockPolicy</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=285 height=153 id="Picture 71"
src="SqlBuildManagerManual_files/image123.jpg"></p>

<p class=MsoNormal>The StoredProcParameterPolicy is additionally configurable
with 4 “Arguments” that are added via &lt;Argument&gt; sub-elements. The
allowed argument names are:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Schema – a stored procedure filter setting. Selects the schema
that the stored procedure must belong to in order to “match” for the policy
check.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>TargetDatabase – a stored procedure filter setting. The target
database that the stored procedure needs to be targeted toward in order to
“match for the policy check.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Parameter – the name of the stored procedure parameter (with the
“@”) that you want to make sure is included in the stored procedure signatures.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>SqlType – the SQL type of the parameter that you want to make
sure is included in the stored procedure signatures.</p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name=FeatureAccessSettings></a><a name="_Toc273689372">Feature Access
Settings</a></h2>

<p class=MsoNormal>There is the ability to activate/deactivate features by
user. Currently, the only feature that is under control is the access to the <a
href="#RemoteServicsExecutionandDeployment">Remote Execution Service</a>. The
&lt;FeatureAccess&gt; element contains both a FeatureId attribute (currently,
only “RemoteExecution” is valid) and a Boolean value of Enabled. A sub-element
of &lt;Allow&gt; takes a LoginId value that should be set to the userid of the
user that has access to the particular feature.</p>

<p class=MsoNormal align=center style='text-align:center'><img border=0
width=342 height=67 id="Picture 74"
src="SqlBuildManagerManual_files/image124.jpg"></p>

</div>

</body>

</html>
