//------------------------------------------------------------------------------
// <autogenerated>
//     This code was generated by a the TypedDataTableBuilder tool.
//     (TypedDataTableBuilder  -- Michael McKechney, author)
//		
//     Visual Studio .NET Custom Tool Setting: TypedTableBuilder
//	   Version: 3.1.1.17637
//
//     Changes to this file may cause incorrect behavior and will be lost if 
//     the code is regenerated.
// <autogenerated>
//------------------------------------------------------------------------------


namespace SqlSync.DbInformation
{

	using System;
	using System.Data;
	using System.Runtime.Serialization;
	using System.Drawing;

	[Serializable()]
	[System.ComponentModel.ToolboxItem(true)]
	[System.ComponentModel.DesignerCategory("Component")]
	[System.ComponentModel.DesignTimeVisible(true)]
	[System.Drawing.ToolboxBitmap(typeof(System.Data.DataSet))]
	public class SizeAnalysisTable : DataTable, System.Collections.IEnumerable
	{
	
	
		private DataColumn columnName;
		private DataColumn columnRowCount;
		private DataColumn columnDataSize;
		private DataColumn columnIndexSize;
		private DataColumn columnUnusedSize;
		private DataColumn columnTotalReservedSize;
		private DataColumn columnAverageDataRowSize;
		private DataColumn columnAverageIndexRowSize;
		public  SizeAnalysisTable(): base("sizeanalysis")
		{
			this.InitClass();
			this.InitVars();
			this.ColumnChanged += new DataColumnChangeEventHandler( myColumn_Changed );
		}
		public SizeAnalysisTable(DataTable table): base(table.TableName)
		{
			this.CaseSensitive = table.CaseSensitive;
			this.Locale = table.Locale;
			this.Namespace = table.Namespace;
			this.Prefix = table.Prefix;
			this.MinimumCapacity = table.MinimumCapacity;
			this.DisplayExpression = table.DisplayExpression;
			this.InitClass();
			this.InitVars();
			this.ColumnChanged += new DataColumnChangeEventHandler( myColumn_Changed );
			foreach(DataRow tmpRow in table.Rows)
			{
				this.ImportRow(tmpRow);
			}
		}
		public SizeAnalysisTable(SerializationInfo info, StreamingContext context):base(info,context)
		{
			this.InitVars();
			this.ColumnChanged += new DataColumnChangeEventHandler( myColumn_Changed );
		}
	
		private void myColumn_Changed( object sender, DataColumnChangeEventArgs e )
		{
			this.InitVars();
		}
		public int Count
		{
			get
			{
				return this.Rows.Count;
			}

		}
		public DataColumn NameColumn
		{
			get
			{
				return this.columnName;
			}

		}
		public DataColumn RowCountColumn
		{
			get
			{
				return this.columnRowCount;
			}

		}
		public DataColumn DataSizeColumn
		{
			get
			{
				return this.columnDataSize;
			}

		}
		public DataColumn IndexSizeColumn
		{
			get
			{
				return this.columnIndexSize;
			}

		}
		public DataColumn UnusedSizeColumn
		{
			get
			{
				return this.columnUnusedSize;
			}

		}
		public DataColumn TotalReservedSizeColumn
		{
			get
			{
				return this.columnTotalReservedSize;
			}

		}
		public DataColumn AverageDataRowSizeColumn
		{
			get
			{
				return this.columnAverageDataRowSize;
			}

		}
		public DataColumn AverageIndexRowSizeColumn
		{
			get
			{
				return this.columnAverageIndexRowSize;
			}

		}
		
		public SizeAnalysisRow this[int index]
		{
			get
			{
				return ((SizeAnalysisRow)(this.Rows[index]));
			}

		}
		public SizeAnalysisRow NewSizeAnalysisRow()
		{
			return ((SizeAnalysisRow)(this.NewRow()));
		}

		public void AddSizeAnalysisRow(SizeAnalysisRow row)
		{
			this.Rows.Add(row);
		}
		public bool AddSizeAnalysisRow(String Name,Int32 RowCount,Int32 DataSize,Int32 IndexSize,Int32 UnusedSize,Int32 TotalReservedSize,Double AverageDataRowSize,Double AverageIndexRowSize)
		{
			SizeAnalysisRow newRow = (SizeAnalysisRow)this.NewRow();
			try
			{	
				newRow.Name = Name;
				newRow.RowCount = RowCount;
				newRow.DataSize = DataSize;
				newRow.IndexSize = IndexSize;
				newRow.UnusedSize = UnusedSize;
				newRow.TotalReservedSize = TotalReservedSize;
				newRow.AverageDataRowSize = AverageDataRowSize;
				newRow.AverageIndexRowSize = AverageIndexRowSize;
				this.Rows.Add(newRow);
			}catch(Exception e)
			{
				throw new System.ApplicationException("Error in Auto-Generated: SizeAnalysisTable.AddSizeAnalysisRow(String,Int32,Int32,Int32,Int32,Int32,Double,Double) Method",e);
			}
			return true;
			
		}
		
		protected override DataRow NewRowFromBuilder(DataRowBuilder builder)
		{
			return new SizeAnalysisRow(builder);
		}
		public void RemoveSizeAnalysisRow(SizeAnalysisRow row)
		{
			this.Rows.Remove(row);
		}
		protected override DataTable CreateInstance()
		{
			return new SizeAnalysisTable();
		}
		
		
		
		public System.Collections.IEnumerator GetEnumerator()
		{
			return this.Rows.GetEnumerator();
		}
		public override DataTable Clone() 
		{
			SizeAnalysisTable cln = ((SizeAnalysisTable)(base.Clone()));
			cln.InitVars();
			return cln;
		}
		internal void InitVars()
		{
			
			this.columnName=this.Columns["Table Name"];
			
			this.columnRowCount=this.Columns["Row Count"];
			
			this.columnDataSize=this.Columns["Data Size"];
			
			this.columnIndexSize=this.Columns["Index Size"];
			
			this.columnUnusedSize=this.Columns["Unused Size"];
			
			this.columnTotalReservedSize=this.Columns["Total Reserved Size"];
			
			this.columnAverageDataRowSize=this.Columns["Average Data Row Size"];
			
			this.columnAverageIndexRowSize=this.Columns["Average Index Row Size"];
			
		}
		private  void InitClass()
		{
		
			this.columnName = new DataColumn("Table Name", typeof(String), null, System.Data.MappingType.Element);
			this.Columns.Add(this.columnName);
		
			this.columnRowCount = new DataColumn("Row Count", typeof(Int32), null, System.Data.MappingType.Element);
			this.Columns.Add(this.columnRowCount);
		
			this.columnDataSize = new DataColumn("Data Size", typeof(Int32), null, System.Data.MappingType.Element);
			this.Columns.Add(this.columnDataSize);
		
			this.columnIndexSize = new DataColumn("Index Size", typeof(Int32), null, System.Data.MappingType.Element);
			this.Columns.Add(this.columnIndexSize);
		
			this.columnUnusedSize = new DataColumn("Unused Size", typeof(Int32), null, System.Data.MappingType.Element);
			this.Columns.Add(this.columnUnusedSize);
		
			this.columnTotalReservedSize = new DataColumn("Total Reserved Size", typeof(Int32), null, System.Data.MappingType.Element);
			this.Columns.Add(this.columnTotalReservedSize);
		
			this.columnAverageDataRowSize = new DataColumn("Average Data Row Size", typeof(Double), null, System.Data.MappingType.Element);
			this.Columns.Add(this.columnAverageDataRowSize);
		
			this.columnAverageIndexRowSize = new DataColumn("Average Index Row Size", typeof(Double), null, System.Data.MappingType.Element);
			this.Columns.Add(this.columnAverageIndexRowSize);
		
		
		
		}

		public DataTable SelectDistinct(string FieldName)
		{	
			string[] FieldNames = new String[]{FieldName};
			return SelectDistinct(FieldNames);
		}

		public DataTable SelectDistinct(string[] FieldNames)
		{	
			bool missMatch = false;
			DataTable dt = new DataTable("distinct_values");
			string fieldNameList = "";
			for(int i=0;i<FieldNames.Length;i++)
			{
				fieldNameList += FieldNames[i];
				if(i!= FieldNames.Length-1)
					fieldNameList += ",";
			}
			
			for(int i=0;i<FieldNames.Length;i++)
			{
				dt.Columns.Add(FieldNames[i], this.Columns[FieldNames[i]].DataType);
			}
			
			object[] LastValue = new object[FieldNames.Length];
			
			foreach (DataRow dr in this.Select("", fieldNameList))
			{
				for(int i=0;i<FieldNames.Length;i++)
				{
					if (  LastValue[i] == null || !(ColumnEqual(LastValue[i], dr[FieldNames[i]])) ) 
					{
						missMatch = true;
						for(int j=0;j<FieldNames.Length;j++)
						{
							LastValue[j] = dr[FieldNames[j]]; 
						}
						break;
					}
				}

				if(missMatch)
				{
					DataRow tmpRow = dt.NewRow();
					for(int i=0;i<FieldNames.Length;i++)
					{
						tmpRow[FieldNames[i]] = LastValue[i];
					}
					dt.Rows.Add(tmpRow);
					missMatch = false;
				}
			}
			return dt;
		}
		
		
		public DataTable SelectDistinct(DataColumn[] DistinctColumns)
		{
			bool missMatch = false;
			DataTable dt = new DataTable("distinct_values");
			string fieldNameList = "";
			for(int i=0;i<DistinctColumns.Length;i++)
			{
				fieldNameList += DistinctColumns[i].ColumnName;
				if(i!= DistinctColumns.Length-1)
					fieldNameList += ",";
			}
			
			for(int i=0;i<DistinctColumns.Length;i++)
			{
				dt.Columns.Add(DistinctColumns[i].ColumnName,DistinctColumns[i].DataType);
			}
			
			object[] LastValue = new object[DistinctColumns.Length];
			
			foreach (DataRow dr in this.Select("", fieldNameList))
			{
				for(int i=0;i<DistinctColumns.Length;i++)
				{
					if (  LastValue[i] == null || !(ColumnEqual(LastValue[i], dr[DistinctColumns[i]])) ) 
					{
						missMatch = true;
						for(int j=0;j<DistinctColumns.Length;j++)
						{
							LastValue[j] = dr[DistinctColumns[j]]; 
						}
						break;
					}
				}
				if(missMatch)
				{
					DataRow tmpRow = dt.NewRow();
					for(int i=0;i<DistinctColumns.Length;i++)
					{
						tmpRow[DistinctColumns[i].ColumnName] = LastValue[i];
					}
					dt.Rows.Add(tmpRow);
					missMatch = false;
				}
			}
			return dt;
		}

		public DataTable SelectDistinct(DataColumn DistinctColumn)
		{
			DataColumn[] DistinctColumns = new DataColumn[]{DistinctColumn};
			return SelectDistinct(DistinctColumns);
		}


		private bool ColumnEqual(object A, object B)
		{
			if (A == System.DBNull.Value && B == System.DBNull.Value)
				 return true; 
			if ( A == System.DBNull.Value || B == System.DBNull.Value ) 
				return false; 
			return ( A.Equals(B) );  
		}


		public bool ImportRows(DataRow[] SourceRows)
		{
			bool importError = false;
			for(int i=0;i<SourceRows.Length;i++)
			{
				try
				{
					this.ImportRow(SourceRows[i]);
				}
				catch(Exception e)
				{
					importError = true;
					throw new System.ApplicationException("Error in Auto-Generated: SizeAnalysisTable.ImportRows(DataRow[]) Method",e);
				}					
				
				
			}
			return importError;
		}
		
		public bool ImportRows( SizeAnalysisRow[] SourceRows)
		{
			bool importError = false;
			for(int i=0;i<SourceRows.Length;i++)
			{
				try
				{
					this.ImportRow( (DataRow)SourceRows[i]);
				}
				catch(Exception e)
				{
					importError = true;
					throw new System.ApplicationException("Error in Auto-Generated: SizeAnalysisTable.ImportRows(SizeAnalysisRow[]) Method",e);
				}					

				
			}
			return importError;
		}
		
		
		//private Exception myLastException;
		//public Exception GetLastException()
		//{
		//	return myLastException;
		//}
		
		public new System.Data.DataRowCollection Rows
		{
			get
			{
				return base.Rows;
			}
		
		}
		
		public virtual bool Fill(string fixedString)
		{
		
		SizeAnalysisRow newRow = (SizeAnalysisRow)this.NewRow();
			try
			{	
				this.Rows.Add(newRow);
			}
			catch(Exception e)
			{
				throw new System.ApplicationException("Error in Auto-Generated: SizeAnalysisTable.Fill(string) Method",e);
			}
			return true;
		
		}

	}
	public class SizeAnalysisRow : DataRow 
	{
		private SizeAnalysisTable tableSizeAnalysisTable;
		internal SizeAnalysisRow(DataRowBuilder rb) : base(rb)
		{
			this.tableSizeAnalysisTable = ((SizeAnalysisTable)(this.Table));
		}
		
		public String Name
		{
			get
			{
				try
				{
					return ((String)(this[this.tableSizeAnalysisTable.NameColumn]));
				}
				catch(InvalidCastException e)
				{
					throw new System.ApplicationException("Error in Auto-Generated: SizeAnalysisRow.Name property. Underlying value is System.DbNull",e);
				}
			}
			set
			{
				this[this.tableSizeAnalysisTable.NameColumn] = value;
			}
		}
		
		public Int32 RowCount
		{
			get
			{
				try
				{
					return ((Int32)(this[this.tableSizeAnalysisTable.RowCountColumn]));
				}
				catch(InvalidCastException e)
				{
					throw new System.ApplicationException("Error in Auto-Generated: SizeAnalysisRow.RowCount property. Underlying value is System.DbNull",e);
				}
			}
			set
			{
				this[this.tableSizeAnalysisTable.RowCountColumn] = value;
			}
		}
		
		public Int32 DataSize
		{
			get
			{
				try
				{
					return ((Int32)(this[this.tableSizeAnalysisTable.DataSizeColumn]));
				}
				catch(InvalidCastException e)
				{
					throw new System.ApplicationException("Error in Auto-Generated: SizeAnalysisRow.DataSize property. Underlying value is System.DbNull",e);
				}
			}
			set
			{
				this[this.tableSizeAnalysisTable.DataSizeColumn] = value;
			}
		}
		
		public Int32 IndexSize
		{
			get
			{
				try
				{
					return ((Int32)(this[this.tableSizeAnalysisTable.IndexSizeColumn]));
				}
				catch(InvalidCastException e)
				{
					throw new System.ApplicationException("Error in Auto-Generated: SizeAnalysisRow.IndexSize property. Underlying value is System.DbNull",e);
				}
			}
			set
			{
				this[this.tableSizeAnalysisTable.IndexSizeColumn] = value;
			}
		}
		
		public Int32 UnusedSize
		{
			get
			{
				try
				{
					return ((Int32)(this[this.tableSizeAnalysisTable.UnusedSizeColumn]));
				}
				catch(InvalidCastException e)
				{
					throw new System.ApplicationException("Error in Auto-Generated: SizeAnalysisRow.UnusedSize property. Underlying value is System.DbNull",e);
				}
			}
			set
			{
				this[this.tableSizeAnalysisTable.UnusedSizeColumn] = value;
			}
		}
		
		public Int32 TotalReservedSize
		{
			get
			{
				try
				{
					return ((Int32)(this[this.tableSizeAnalysisTable.TotalReservedSizeColumn]));
				}
				catch(InvalidCastException e)
				{
					throw new System.ApplicationException("Error in Auto-Generated: SizeAnalysisRow.TotalReservedSize property. Underlying value is System.DbNull",e);
				}
			}
			set
			{
				this[this.tableSizeAnalysisTable.TotalReservedSizeColumn] = value;
			}
		}
		
		public Double AverageDataRowSize
		{
			get
			{
				try
				{
					return ((Double)(this[this.tableSizeAnalysisTable.AverageDataRowSizeColumn]));
				}
				catch(InvalidCastException e)
				{
					throw new System.ApplicationException("Error in Auto-Generated: SizeAnalysisRow.AverageDataRowSize property. Underlying value is System.DbNull",e);
				}
			}
			set
			{
				this[this.tableSizeAnalysisTable.AverageDataRowSizeColumn] = value;
			}
		}
		
		public Double AverageIndexRowSize
		{
			get
			{
				try
				{
					return ((Double)(this[this.tableSizeAnalysisTable.AverageIndexRowSizeColumn]));
				}
				catch(InvalidCastException e)
				{
					throw new System.ApplicationException("Error in Auto-Generated: SizeAnalysisRow.AverageIndexRowSize property. Underlying value is System.DbNull",e);
				}
			}
			set
			{
				this[this.tableSizeAnalysisTable.AverageIndexRowSizeColumn] = value;
			}
		}
		
		public bool SyncRowValues(DataRow SourceRow)
		{
			bool syncErrors = false;
			
			try
			{
				this[this.tableSizeAnalysisTable.NameColumn] = SourceRow["Table Name"];
			}
			catch(Exception e)
			{
				syncErrors = true;
				throw new System.ApplicationException("Error in Auto-Generated: SyncRowValues(DataRow) Method",e);
			}
			
			try
			{
				this[this.tableSizeAnalysisTable.RowCountColumn] = SourceRow["Row Count"];
			}
			catch(Exception e)
			{
				syncErrors = true;
				throw new System.ApplicationException("Error in Auto-Generated: SyncRowValues(DataRow) Method",e);
			}
			
			try
			{
				this[this.tableSizeAnalysisTable.DataSizeColumn] = SourceRow["Data Size"];
			}
			catch(Exception e)
			{
				syncErrors = true;
				throw new System.ApplicationException("Error in Auto-Generated: SyncRowValues(DataRow) Method",e);
			}
			
			try
			{
				this[this.tableSizeAnalysisTable.IndexSizeColumn] = SourceRow["Index Size"];
			}
			catch(Exception e)
			{
				syncErrors = true;
				throw new System.ApplicationException("Error in Auto-Generated: SyncRowValues(DataRow) Method",e);
			}
			
			try
			{
				this[this.tableSizeAnalysisTable.UnusedSizeColumn] = SourceRow["Unused Size"];
			}
			catch(Exception e)
			{
				syncErrors = true;
				throw new System.ApplicationException("Error in Auto-Generated: SyncRowValues(DataRow) Method",e);
			}
			
			try
			{
				this[this.tableSizeAnalysisTable.TotalReservedSizeColumn] = SourceRow["Total Reserved Size"];
			}
			catch(Exception e)
			{
				syncErrors = true;
				throw new System.ApplicationException("Error in Auto-Generated: SyncRowValues(DataRow) Method",e);
			}
			
			try
			{
				this[this.tableSizeAnalysisTable.AverageDataRowSizeColumn] = SourceRow["Average Data Row Size"];
			}
			catch(Exception e)
			{
				syncErrors = true;
				throw new System.ApplicationException("Error in Auto-Generated: SyncRowValues(DataRow) Method",e);
			}
			
			try
			{
				this[this.tableSizeAnalysisTable.AverageIndexRowSizeColumn] = SourceRow["Average Index Row Size"];
			}
			catch(Exception e)
			{
				syncErrors = true;
				throw new System.ApplicationException("Error in Auto-Generated: SyncRowValues(DataRow) Method",e);
			}
			
			return syncErrors;
		
		}
		
		public bool SyncRowValues(SizeAnalysisRow SourceRow)
		{
			return SyncRowValues( (DataRow)SourceRow);
		}
	}

}