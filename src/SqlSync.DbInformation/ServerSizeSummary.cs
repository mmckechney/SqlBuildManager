//------------------------------------------------------------------------------
// <autogenerated>
//     This code was generated by a the TypedDataTableBuilder tool.
//     (TypedDataTableBuilder  -- Michael McKechney, author)
//		
//     Visual Studio .NET Custom Tool Setting: TypedTableBuilder
//	   Version: 3.1.1.17637
//
//     Changes to this file may cause incorrect behavior and will be lost if 
//     the code is regenerated.
// <autogenerated>
//------------------------------------------------------------------------------


namespace SqlSync.DbInformation
{

	using System;
	using System.Data;
	using System.Runtime.Serialization;
	using System.Drawing;

	[Serializable()]
	[System.ComponentModel.ToolboxItem(true)]
	[System.ComponentModel.DesignerCategory("Component")]
	[System.ComponentModel.DesignTimeVisible(true)]
	public class ServerSizeSummary : DataTable, System.Collections.IEnumerable
	{
	
	
		private DataColumn columnDatabaseName;
		private DataColumn columnLocation;
		private DataColumn columnDataSize;
		private DataColumn columnDateCreated;
		public  ServerSizeSummary(): base("serversizesummary")
		{
			this.InitClass();
			this.InitVars();
			this.ColumnChanged += new DataColumnChangeEventHandler( myColumn_Changed );
		}
		public ServerSizeSummary(DataTable table): base(table.TableName)
		{
			this.CaseSensitive = table.CaseSensitive;
			this.Locale = table.Locale;
			this.Namespace = table.Namespace;
			this.Prefix = table.Prefix;
			this.MinimumCapacity = table.MinimumCapacity;
			this.DisplayExpression = table.DisplayExpression;
			this.InitClass();
			this.InitVars();
			this.ColumnChanged += new DataColumnChangeEventHandler( myColumn_Changed );
			foreach(DataRow tmpRow in table.Rows)
			{
				this.ImportRow(tmpRow);
			}
		}
		public ServerSizeSummary(SerializationInfo info, StreamingContext context):base(info,context)
		{
			this.InitVars();
			this.ColumnChanged += new DataColumnChangeEventHandler( myColumn_Changed );
		}
	
		private void myColumn_Changed( object sender, DataColumnChangeEventArgs e )
		{
			this.InitVars();
		}
		public int Count
		{
			get
			{
				return this.Rows.Count;
			}

		}
		public DataColumn DatabaseNameColumn
		{
			get
			{
				return this.columnDatabaseName;
			}

		}
		public DataColumn LocationColumn
		{
			get
			{
				return this.columnLocation;
			}

		}
		public DataColumn DataSizeColumn
		{
			get
			{
				return this.columnDataSize;
			}

		}
		public DataColumn DateCreatedColumn
		{
			get
			{
				return this.columnDateCreated;
			}

		}
		
		public ServerSizeSummaryRow this[int index]
		{
			get
			{
				return ((ServerSizeSummaryRow)(this.Rows[index]));
			}

		}
		public ServerSizeSummaryRow NewServerSizeSummaryRow()
		{
			return ((ServerSizeSummaryRow)(this.NewRow()));
		}

		public void AddServerSizeSummaryRow(ServerSizeSummaryRow row)
		{
			this.Rows.Add(row);
		}
		public bool AddServerSizeSummaryRow(String DatabaseName,String Location,Int64 DataSize,DateTime DateCreated)
		{
			ServerSizeSummaryRow newRow = (ServerSizeSummaryRow)this.NewRow();
			try
			{	
				newRow.DatabaseName = DatabaseName;
				newRow.Location = Location;
				newRow.DataSize = DataSize;
				newRow.DateCreated = DateCreated;
				this.Rows.Add(newRow);
			}catch(Exception e)
			{
				throw new System.ApplicationException("Error in Auto-Generated: ServerSizeSummary.AddServerSizeSummaryRow(String,String,Int64,DateTime) Method",e);
			}
			return true;
			
		}
		
		protected override DataRow NewRowFromBuilder(DataRowBuilder builder)
		{
			return new ServerSizeSummaryRow(builder);
		}
		public void RemoveServerSizeSummaryRow(ServerSizeSummaryRow row)
		{
			this.Rows.Remove(row);
		}
		protected override DataTable CreateInstance()
		{
			return new ServerSizeSummary();
		}
		
		
		
		public System.Collections.IEnumerator GetEnumerator()
		{
			return this.Rows.GetEnumerator();
		}
		public override DataTable Clone() 
		{
			ServerSizeSummary cln = ((ServerSizeSummary)(base.Clone()));
			cln.InitVars();
			return cln;
		}
		internal void InitVars()
		{
			
			this.columnDatabaseName=this.Columns["DatabaseName"];
			
			this.columnLocation=this.Columns["Location"];
			
			this.columnDataSize=this.Columns["DataSize"];
			
			this.columnDateCreated=this.Columns["DateCreated"];
			
		}
		private  void InitClass()
		{
		
			this.columnDatabaseName = new DataColumn("DatabaseName", typeof(String), null, System.Data.MappingType.Element);
			this.Columns.Add(this.columnDatabaseName);
		
			this.columnLocation = new DataColumn("Location", typeof(String), null, System.Data.MappingType.Element);
			this.Columns.Add(this.columnLocation);
		
			this.columnDataSize = new DataColumn("DataSize", typeof(Int64), null, System.Data.MappingType.Element);
			this.Columns.Add(this.columnDataSize);
		
			this.columnDateCreated = new DataColumn("DateCreated", typeof(DateTime), null, System.Data.MappingType.Element);
			this.Columns.Add(this.columnDateCreated);
		
		
		
		}

		public DataTable SelectDistinct(string FieldName)
		{	
			string[] FieldNames = new String[]{FieldName};
			return SelectDistinct(FieldNames);
		}

		public DataTable SelectDistinct(string[] FieldNames)
		{	
			bool missMatch = false;
			DataTable dt = new DataTable("distinct_values");
			string fieldNameList = "";
			for(int i=0;i<FieldNames.Length;i++)
			{
				fieldNameList += FieldNames[i];
				if(i!= FieldNames.Length-1)
					fieldNameList += ",";
			}
			
			for(int i=0;i<FieldNames.Length;i++)
			{
				dt.Columns.Add(FieldNames[i], this.Columns[FieldNames[i]].DataType);
			}
			
			object[] LastValue = new object[FieldNames.Length];
			
			foreach (DataRow dr in this.Select("", fieldNameList))
			{
				for(int i=0;i<FieldNames.Length;i++)
				{
					if (  LastValue[i] == null || !(ColumnEqual(LastValue[i], dr[FieldNames[i]])) ) 
					{
						missMatch = true;
						for(int j=0;j<FieldNames.Length;j++)
						{
							LastValue[j] = dr[FieldNames[j]]; 
						}
						break;
					}
				}

				if(missMatch)
				{
					DataRow tmpRow = dt.NewRow();
					for(int i=0;i<FieldNames.Length;i++)
					{
						tmpRow[FieldNames[i]] = LastValue[i];
					}
					dt.Rows.Add(tmpRow);
					missMatch = false;
				}
			}
			return dt;
		}
		
		
		public DataTable SelectDistinct(DataColumn[] DistinctColumns)
		{
			bool missMatch = false;
			DataTable dt = new DataTable("distinct_values");
			string fieldNameList = "";
			for(int i=0;i<DistinctColumns.Length;i++)
			{
				fieldNameList += DistinctColumns[i].ColumnName;
				if(i!= DistinctColumns.Length-1)
					fieldNameList += ",";
			}
			
			for(int i=0;i<DistinctColumns.Length;i++)
			{
				dt.Columns.Add(DistinctColumns[i].ColumnName,DistinctColumns[i].DataType);
			}
			
			object[] LastValue = new object[DistinctColumns.Length];
			
			foreach (DataRow dr in this.Select("", fieldNameList))
			{
				for(int i=0;i<DistinctColumns.Length;i++)
				{
					if (  LastValue[i] == null || !(ColumnEqual(LastValue[i], dr[DistinctColumns[i]])) ) 
					{
						missMatch = true;
						for(int j=0;j<DistinctColumns.Length;j++)
						{
							LastValue[j] = dr[DistinctColumns[j]]; 
						}
						break;
					}
				}
				if(missMatch)
				{
					DataRow tmpRow = dt.NewRow();
					for(int i=0;i<DistinctColumns.Length;i++)
					{
						tmpRow[DistinctColumns[i].ColumnName] = LastValue[i];
					}
					dt.Rows.Add(tmpRow);
					missMatch = false;
				}
			}
			return dt;
		}

		public DataTable SelectDistinct(DataColumn DistinctColumn)
		{
			DataColumn[] DistinctColumns = new DataColumn[]{DistinctColumn};
			return SelectDistinct(DistinctColumns);
		}


		private bool ColumnEqual(object A, object B)
		{
			if (A == System.DBNull.Value && B == System.DBNull.Value)
				 return true; 
			if ( A == System.DBNull.Value || B == System.DBNull.Value ) 
				return false; 
			return ( A.Equals(B) );  
		}


		public bool ImportRows(DataRow[] SourceRows)
		{
			bool importError = false;
			for(int i=0;i<SourceRows.Length;i++)
			{
				try
				{
					this.ImportRow(SourceRows[i]);
				}
				catch(Exception e)
				{
					importError = true;
					throw new System.ApplicationException("Error in Auto-Generated: ServerSizeSummary.ImportRows(DataRow[]) Method",e);
				}					
				
				
			}
			return importError;
		}
		
		public bool ImportRows( ServerSizeSummaryRow[] SourceRows)
		{
			bool importError = false;
			for(int i=0;i<SourceRows.Length;i++)
			{
				try
				{
					this.ImportRow( (DataRow)SourceRows[i]);
				}
				catch(Exception e)
				{
					importError = true;
					throw new System.ApplicationException("Error in Auto-Generated: ServerSizeSummary.ImportRows(ServerSizeSummaryRow[]) Method",e);
				}					

				
			}
			return importError;
		}
		
		
		//private Exception myLastException;
		//public Exception GetLastException()
		//{
		//	return myLastException;
		//}
		
		public new System.Data.DataRowCollection Rows
		{
			get
			{
				return base.Rows;
			}
		
		}
		
		public virtual bool Fill(string fixedString)
		{
		
		ServerSizeSummaryRow newRow = (ServerSizeSummaryRow)this.NewRow();
			try
			{	
				this.Rows.Add(newRow);
			}
			catch(Exception e)
			{
				throw new System.ApplicationException("Error in Auto-Generated: ServerSizeSummary.Fill(string) Method",e);
			}
			return true;
		
		}

	}
	public class ServerSizeSummaryRow : DataRow 
	{
		private ServerSizeSummary tableServerSizeSummary;
		internal ServerSizeSummaryRow(DataRowBuilder rb) : base(rb)
		{
			this.tableServerSizeSummary = ((ServerSizeSummary)(this.Table));
		}
		
		public String DatabaseName
		{
			get
			{
				try
				{
					return ((String)(this[this.tableServerSizeSummary.DatabaseNameColumn]));
				}
				catch(InvalidCastException e)
				{
					throw new System.ApplicationException("Error in Auto-Generated: ServerSizeSummaryRow.DatabaseName property. Underlying value is System.DbNull",e);
				}
			}
			set
			{
				this[this.tableServerSizeSummary.DatabaseNameColumn] = value;
			}
		}
		
		public String Location
		{
			get
			{
				try
				{
					return ((String)(this[this.tableServerSizeSummary.LocationColumn]));
				}
				catch(InvalidCastException e)
				{
					throw new System.ApplicationException("Error in Auto-Generated: ServerSizeSummaryRow.Location property. Underlying value is System.DbNull",e);
				}
			}
			set
			{
				this[this.tableServerSizeSummary.LocationColumn] = value;
			}
		}
		
		public Int64 DataSize
		{
			get
			{
				try
				{
					return ((Int64)(this[this.tableServerSizeSummary.DataSizeColumn]));
				}
				catch(InvalidCastException e)
				{
					throw new System.ApplicationException("Error in Auto-Generated: ServerSizeSummaryRow.DataSize property. Underlying value is System.DbNull",e);
				}
			}
			set
			{
				this[this.tableServerSizeSummary.DataSizeColumn] = value;
			}
		}
		
		public DateTime DateCreated
		{
			get
			{
				try
				{
					return ((DateTime)(this[this.tableServerSizeSummary.DateCreatedColumn]));
				}
				catch(InvalidCastException e)
				{
					throw new System.ApplicationException("Error in Auto-Generated: ServerSizeSummaryRow.DateCreated property. Underlying value is System.DbNull",e);
				}
			}
			set
			{
				this[this.tableServerSizeSummary.DateCreatedColumn] = value;
			}
		}
		
		public bool SyncRowValues(DataRow SourceRow)
		{
			bool syncErrors = false;
			
			try
			{
				this[this.tableServerSizeSummary.DatabaseNameColumn] = SourceRow["DatabaseName"];
			}
			catch(Exception e)
			{
				syncErrors = true;
				throw new System.ApplicationException("Error in Auto-Generated: SyncRowValues(DataRow) Method",e);
			}
			
			try
			{
				this[this.tableServerSizeSummary.LocationColumn] = SourceRow["Location"];
			}
			catch(Exception e)
			{
				syncErrors = true;
				throw new System.ApplicationException("Error in Auto-Generated: SyncRowValues(DataRow) Method",e);
			}
			
			try
			{
				this[this.tableServerSizeSummary.DataSizeColumn] = SourceRow["DataSize"];
			}
			catch(Exception e)
			{
				syncErrors = true;
				throw new System.ApplicationException("Error in Auto-Generated: SyncRowValues(DataRow) Method",e);
			}
			
			try
			{
				this[this.tableServerSizeSummary.DateCreatedColumn] = SourceRow["DateCreated"];
			}
			catch(Exception e)
			{
				syncErrors = true;
				throw new System.ApplicationException("Error in Auto-Generated: SyncRowValues(DataRow) Method",e);
			}
			
			return syncErrors;
		
		}
		
		public bool SyncRowValues(ServerSizeSummaryRow SourceRow)
		{
			return SyncRowValues( (DataRow)SourceRow);
		}
	}

}